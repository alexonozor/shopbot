"use strict";(self.webpackChunkshopbot=self.webpackChunkshopbot||[]).push([[327],{6327:(rt,y,s)=>{s.r(y),s.d(y,{PayoutsModule:()=>ct});var d=s(6814),u=s(1896),t=s(5879);let S=(()=>{class n{constructor(){}ngOnInit(){}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-payouts"]],decls:1,vars:0,template:function(o,i){1&o&&t._UZ(0,"router-outlet")},dependencies:[u.lC]})}return n})();var x=s(3365),r=s(5313),L=s(8337),h=s(6567),w=s(553),U=s(9862);let m=(()=>{class n{constructor(e){this._httpClient=e,this.hostServer=w.N.hostServer}createTransaction(e){return this._httpClient.post(`${this.hostServer}/transactions`,e)}undoTransaction(e){return this._httpClient.post(`${this.hostServer}/transactions/undo/transaction`,e)}getTransactions(){return this._httpClient.get(`${this.hostServer}/transactions`)}getTransaction(e){return this._httpClient.get(`${this.hostServer}/transactions/${e}`)}updateTransaction(e,o){return this._httpClient.put(`${this.hostServer}/transactions/${e}`,o)}deleteTransaction(e){return this._httpClient.delete(`${this.hostServer}/transactions/${e}`)}static#t=this.\u0275fac=function(o){return new(o||n)(t.LFG(U.eN))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac})}return n})();var T=s(7700),k=s(2939),f=s(2296),Z=s(617),D=s(5986),g=s(7988),p=s(3814);function P(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"span",2)(1,"button",20),t._uU(2),t.qZA(),t.TgZ(3,"button",21),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.deleteSelected())}),t.TgZ(4,"mat-icon",22),t._uU(5,"delete"),t.qZA(),t._uU(6," Delete Selected Fund Request"),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(2),t.hij("",e.selection.selected.length," Selected")}}function F(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"th",23)(1,"mat-checkbox",24),t.NdJ("change",function(i){t.CHM(e);const c=t.oxw();return t.KtG(i?c.toggleAllRows():null)}),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("checked",e.selection.hasValue()&&e.isAllSelected())("indeterminate",e.selection.hasValue()&&!e.isAllSelected())("aria-label",e.checkboxLabel())}}function q(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"td",25)(1,"mat-checkbox",26),t.NdJ("click",function(i){return i.stopPropagation()})("change",function(i){const l=t.CHM(e).$implicit,_=t.oxw();return t.KtG(i?_.selection.toggle(l):null)}),t.qZA()()}if(2&n){const e=a.$implicit,o=t.oxw();t.xp6(1),t.Q6J("checked",o.selection.isSelected(e))("aria-label",o.checkboxLabel(e))}}function R(n,a){1&n&&(t.TgZ(0,"th",23),t._uU(1,"Created At"),t.qZA())}function N(n,a){if(1&n&&(t.TgZ(0,"td",25),t._uU(1),t.ALo(2,"date"),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e.createdAt,"medium"))}}function Y(n,a){1&n&&(t.TgZ(0,"th",23),t._uU(1,"Vendor"),t.qZA())}function $(n,a){if(1&n&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.Oqu(e.store.name)}}function M(n,a){1&n&&(t.TgZ(0,"th",23),t._uU(1,"Number of orders"),t.qZA())}function Q(n,a){if(1&n&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.Oqu(e.orders.length)}}function J(n,a){1&n&&(t.TgZ(0,"th",23),t._uU(1,"Type"),t.qZA())}function B(n,a){if(1&n&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.hij(" ",e.transactionType||"Credit","")}}function G(n,a){1&n&&(t.TgZ(0,"th",23),t._uU(1,"Remarks"),t.qZA())}function O(n,a){if(1&n&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.hij(" ",e.remark||"Payout","")}}function I(n,a){1&n&&(t.TgZ(0,"th",23),t._uU(1,"Total"),t.qZA())}function H(n,a){if(1&n&&(t.TgZ(0,"td",25),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e.totalAmount,e.store.currency))}}function j(n,a){1&n&&(t.TgZ(0,"th",23),t._uU(1,"Actions"),t.qZA())}const z=function(n){return["../",n,"edit"]};function K(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"td",25)(1,"button",27),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(2,"mat-icon"),t._uU(3,"more_vert"),t.qZA()(),t.TgZ(4,"mat-menu",null,28)(6,"button",29),t.NdJ("click",function(){const i=t.CHM(e),c=i.$implicit,l=i.index,_=t.oxw();return t.KtG(_.deleteTransaction(c._id,l))}),t.TgZ(7,"mat-icon",30),t._uU(8,"delete"),t.qZA(),t.TgZ(9,"span"),t._uU(10,"Delete"),t.qZA()(),t.TgZ(11,"button",31)(12,"mat-icon",30),t._uU(13,"visibility"),t.qZA(),t.TgZ(14,"span"),t._uU(15,"View Request"),t.qZA()(),t.TgZ(16,"button",29),t.NdJ("click",function(){const c=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.undoTransaction(c))}),t.TgZ(17,"mat-icon",30),t._uU(18,"undo"),t.qZA(),t.TgZ(19,"span"),t._uU(20,"Undo Transaction"),t.qZA()()()()}if(2&n){const e=a.$implicit,o=t.MAs(5);t.xp6(1),t.Q6J("matMenuTriggerFor",o),t.xp6(10),t.Q6J("routerLink",t.VKq(2,z,e._id))}}function E(n,a){1&n&&t._UZ(0,"tr",32)}function V(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"tr",33),t.NdJ("click",function(){const c=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.openModal(c._id))}),t.qZA()}}const X=function(){return[15,30,60]};let W=(()=>{class n{constructor(e,o,i,c,l){this.route=e,this.transactionsService=o,this._matDialog=i,this.router=c,this.snackBar=l,this.displayedColumns=["select","createdAt","vendor","orders","type","remark","total","actions"],this.dataSource=new r.by([]),this.selection=new L.Ov(!0,[])}ngAfterViewInit(){this.dataSource.paginator=this.paginator}ngOnInit(){this.dataSource=new r.by(this.route.snapshot.data.transactions)}openModal(e){this.router.navigate(["dashboard","reports","payouts",e,"details"])}isAllSelected(){return this.selection.selected.length===this.dataSource.data.length}toggleAllRows(){this.isAllSelected()?this.selection.clear():this.selection.select(...this.dataSource.data)}undoTransaction(e){this.confirmDialogRef=this._matDialog.open(h.X,{disableClose:!1}),this.confirmDialogRef.componentInstance.title="Undo transaction?",this.confirmDialogRef.componentInstance.confirmMessage="Are you sure you want to undo this transaction?",this.confirmDialogRef.componentInstance.confirmButton="Undo",this.confirmDialogRef.afterClosed().subscribe(o=>{this.transactionsService.undoTransaction(e).subscribe(i=>{this.snackBar.open("Transaction has been undone","okay",{duration:3e3})})})}deleteSelected(){this.confirmDialogRef=this._matDialog.open(h.X,{disableClose:!1}),this.confirmDialogRef.componentInstance.title="Delete Fund Request?",this.confirmDialogRef.componentInstance.confirmMessage="Are you sure you want to delete these Fund Request?",this.confirmDialogRef.componentInstance.confirmButton="Delete",this.confirmDialogRef.afterClosed().subscribe(e=>{e&&this.selection.selected.forEach((o,i)=>{this.dataSource.data.splice(i,1),this.dataSource=new r.by(this.dataSource.data),this.dataSource._updateChangeSubscription(),this.dataSource.paginator=this.paginator,this.transactionsService.deleteTransaction(o._id).subscribe()})})}checkboxLabel(e){return e?`${this.selection.isSelected(e)?"deselect":"select"} row ${e.position+1}`:(this.isAllSelected()?"deselect":"select")+" all"}deleteTransaction(e,o){this.confirmDialogRef=this._matDialog.open(h.X,{disableClose:!1}),this.confirmDialogRef.componentInstance.title="Delete Fund Requests?",this.confirmDialogRef.componentInstance.confirmMessage="Are you sure you want to delete this Fund Requests?",this.confirmDialogRef.componentInstance.confirmButton="Delete",this.confirmDialogRef.afterClosed().subscribe(i=>{i&&(this.dataSource.data.splice(o,1),this.dataSource=new r.by(this.dataSource.data),this.dataSource._updateChangeSubscription(),this.dataSource.paginator=this.paginator,this.transactionsService.deleteTransaction(e).subscribe())})}update(e,o){this.transactionsService.updateTransaction(e,{enabled:o.checked}).subscribe(i=>{})}static#t=this.\u0275fac=function(o){return new(o||n)(t.Y36(u.gz),t.Y36(m),t.Y36(T.uw),t.Y36(u.F0),t.Y36(k.ux))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-payouts-list"]],viewQuery:function(o,i){if(1&o&&t.Gf(x.NW,5),2&o){let c;t.iGM(c=t.CRH())&&(i.paginator=c.first)}},decls:35,vars:6,consts:[[1,"h-screen","w-full"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","start center",1,"card","bg-white","w-full","mat-elevation-z2","px-2","py-2"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","10px",1,"text-lg","font-thin"],[1,"text-2xl"],["class","text-lg font-thin","fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","10px",4,"ngIf"],[1,"mat-elevation-z8"],["mat-table","",1,"w-full",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","createdAt"],["matColumnDef","vendor"],["matColumnDef","orders"],["matColumnDef","type"],["matColumnDef","remark"],["matColumnDef","total"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","cursor-pointer",3,"click",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page of periodic elements",3,"pageSizeOptions"],["mat-button",""],["mat-stroked-button","","color","warn",3,"click"],[1,"mat-18"],["mat-header-cell",""],[3,"checked","indeterminate","aria-label","change"],["mat-cell",""],[3,"checked","aria-label","click","change"],["mat-icon-button","","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor","click"],["menu","matMenu"],["mat-menu-item","",3,"click"],[1,"material-icons-outlined"],["mat-menu-item","",3,"routerLink"],["mat-header-row",""],["mat-row","",1,"cursor-pointer",3,"click"]],template:function(o,i){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"span",2)(3,"span",3),t._uU(4,"Payout Settlement"),t.qZA()(),t.YNc(5,P,7,1,"span",4),t.qZA(),t.TgZ(6,"div",5)(7,"table",6),t.ynx(8,7),t.YNc(9,F,2,3,"th",8),t.YNc(10,q,2,2,"td",9),t.BQk(),t.ynx(11,10),t.YNc(12,R,2,0,"th",8),t.YNc(13,N,3,4,"td",9),t.BQk(),t.ynx(14,11),t.YNc(15,Y,2,0,"th",8),t.YNc(16,$,2,1,"td",9),t.BQk(),t.ynx(17,12),t.YNc(18,M,2,0,"th",8),t.YNc(19,Q,2,1,"td",9),t.BQk(),t.ynx(20,13),t.YNc(21,J,2,0,"th",8),t.YNc(22,B,2,1,"td",9),t.BQk(),t.ynx(23,14),t.YNc(24,G,2,0,"th",8),t.YNc(25,O,2,1,"td",9),t.BQk(),t.ynx(26,15),t.YNc(27,I,2,0,"th",8),t.YNc(28,H,3,4,"td",9),t.BQk(),t.ynx(29,16),t.YNc(30,j,2,0,"th",8),t.YNc(31,K,21,4,"td",9),t.BQk(),t.YNc(32,E,1,0,"tr",17),t.YNc(33,V,1,0,"tr",18),t.qZA(),t._UZ(34,"mat-paginator",19),t.qZA()()),2&o&&(t.xp6(5),t.Q6J("ngIf",i.selection.selected.length),t.xp6(2),t.Q6J("dataSource",i.dataSource),t.xp6(25),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(5,X)))},dependencies:[d.O5,u.rH,f.lW,f.RK,Z.Hw,x.NW,r.BZ,r.fO,r.as,r.w1,r.Dz,r.nj,r.ge,r.ev,r.XQ,r.Gk,D.oG,g.VK,g.OP,g.p6,p.xw,p.SQ,p.Wh,d.H9,d.uU]})}return n})(),v=(()=>{class n{constructor(e){this.transactionsService=e}resolve(){return this.transactionsService.getTransactions()}static#t=this.\u0275fac=function(o){return new(o||n)(t.LFG(m))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),C=(()=>{class n{constructor(e){this.transactionService=e}resolve(e){const o=e.paramMap.get("id");return this.transactionService.getTransaction(o)}static#t=this.\u0275fac=function(o){return new(o||n)(t.LFG(m))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function tt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"li",13),t.NdJ("click",function(){const c=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.goToOrder(c._id))}),t.TgZ(1,"div",6)(2,"div",7)(3,"p",8),t._uU(4),t.qZA()(),t.TgZ(5,"div",7)(6,"p",8),t._uU(7),t.ALo(8,"date"),t.qZA()(),t.TgZ(9,"div",9),t._uU(10),t.ALo(11,"currency"),t.qZA()()()}if(2&n){const e=a.$implicit,o=t.oxw();t.xp6(4),t.hij(" ",e.payment," "),t.xp6(3),t.hij(" ",t.xi3(8,3,e.createdAt,"meduim")," "),t.xp6(3),t.hij(" ",t.xi3(11,6,e.total-e.serviceFee-e.shippingFee-(e.total-e.serviceFee-e.shippingFee)/100*e.vendorCommission,o.transaction.store.currency)," ")}}let A=(()=>{class n{constructor(e,o,i){this.route=e,this.transactionsService=o,this.router=i,this.transaction=this.route.snapshot.data.transaction}ngOnInit(){}closeModal(){this.router.navigate(["dashboard","reports","payouts","list"])}goToOrder(e){this.router.navigate(["dashboard","orders",e,"details"])}static#t=this.\u0275fac=function(o){return new(o||n)(t.Y36(u.gz),t.Y36(m),t.Y36(u.F0))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-payouts-details"]],decls:49,vars:11,consts:[[1,"mat-elevation-z8","container","mx-auto","my-10","p-5",2,"width","40rem"],["fxLayout","row","fxLayoutAlign","space-between center",1,"mb-3"],[1,"text-slate-500"],["mat-icon-button","",3,"click"],[1,"divide-y","w-full","divide-gray-200"],[1,"pb-3","sm:pb-4"],[1,"flex","items-center","space-x-4"],[1,"flex-1","min-w-0"],[1,"text-sm","font-medium","text-gray-900","truncate"],[1,"inline-flex","items-center","text-base","font-semibold","text-gray-900"],[1,"py-3","sm:py-4"],[1,"divide-y","w-full","divide-gray-100"],["class","py-3 sm:py-4 hover:bg-slate-300 cursor-pointer",3,"click",4,"ngFor","ngForOf"],[1,"py-3","sm:py-4","hover:bg-slate-300","cursor-pointer",3,"click"]],template:function(o,i){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h3",2),t._uU(3,"Settlement information"),t.qZA(),t.TgZ(4,"button",3),t.NdJ("click",function(){return i.closeModal()}),t.TgZ(5,"mat-icon"),t._uU(6,"close"),t.qZA()()(),t.TgZ(7,"ul",4)(8,"li",5)(9,"div",6)(10,"div",7)(11,"p",8),t._uU(12," Reference "),t.qZA()(),t.TgZ(13,"div",9),t._uU(14),t.qZA()()(),t.TgZ(15,"li",10)(16,"div",6)(17,"div",7)(18,"p",8),t._uU(19," Store / Vendor "),t.qZA()(),t.TgZ(20,"div",9),t._uU(21),t.qZA()()(),t.TgZ(22,"li",10)(23,"div",6)(24,"div",7)(25,"p",8),t._uU(26," Created "),t.qZA()(),t.TgZ(27,"div",9),t._uU(28),t.ALo(29,"date"),t.qZA()()(),t.TgZ(30,"li",10)(31,"div",6)(32,"div",7)(33,"p",8),t._uU(34," Status "),t.qZA()(),t.TgZ(35,"div",9),t._uU(36),t.qZA()()(),t.TgZ(37,"li",10)(38,"div",6)(39,"div",7)(40,"p",8),t._uU(41," Fee "),t.qZA()(),t.TgZ(42,"div",9),t._uU(43),t.ALo(44,"currency"),t.qZA()()()(),t.TgZ(45,"h3",2),t._uU(46,"Orders that make up this settlement"),t.qZA(),t.TgZ(47,"ul",11),t.YNc(48,tt,12,9,"li",12),t.qZA()()),2&o&&(t.xp6(14),t.hij(" ",i.transaction.reference," "),t.xp6(7),t.hij(" ",i.transaction.store.name," "),t.xp6(7),t.hij(" ",t.lcZ(29,6,i.transaction.createdAt)," "),t.xp6(8),t.hij(" ",i.transaction.status," "),t.xp6(7),t.hij(" ",t.xi3(44,8,i.transaction.totalAmount,i.transaction.store.currency)," "),t.xp6(5),t.Q6J("ngForOf",i.transaction.orders))},dependencies:[d.sg,f.RK,Z.Hw,p.xw,p.Wh,d.H9,d.uU]})}return n})();const et=[{path:"",component:S,children:[{path:"list",component:W,resolve:{transactions:v}},{path:":id/details",component:A,resolve:{transaction:C}}]}];let nt=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({imports:[u.Bz.forChild(et),u.Bz]})}return n})();var ot=s(1447),b=s(6223),it=s(6005),at=s(6208);let st=(()=>{class n{constructor(e,o){this.dialog=e,this.router=o}canActivate(e,o){const i=e.paramMap.get("id");return this.dialog.open(A,{data:{id:i}}),!1}static#t=this.\u0275fac=function(o){return new(o||n)(t.LFG(T.uw),t.LFG(u.F0))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac})}return n})(),ct=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({providers:[m,v,C,st],imports:[d.ez,nt,it.q,ot.o9,b.UX,b.u5,at.m]})}return n})()}}]);