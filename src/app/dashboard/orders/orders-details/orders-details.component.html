<div class="lg:flex lg:items-center lg:justify-between">
  <div class="min-w-0 flex-1">
    <h2 class="text-2xl font-bold leading-7 text-gray-900 sm:truncate sm:text-3xl sm:tracking-tight">Order ID
      #{{order.reference}}</h2>
    <div class="mt-1 flex flex-col sm:mt-0 sm:flex-row sm:flex-wrap sm:space-x-6">
      <div class="mt-2 flex items-center text-sm text-gray-500">
        <mat-icon class="mat-18" class="material-icons-outlined">card_travel</mat-icon>

        {{order.payment}}
      </div>
      <div class="mt-2 flex items-center text-sm text-gray-500">
        <!-- Heroicon name: mini/map-pin -->
        <mat-icon class="mat-18" class="material-icons-outlined">credit_score</mat-icon>
        {{order.paymentStatus}}
      </div>
      <div class="mt-2 flex items-center text-sm text-black">
        <!-- Heroicon name: mini/currency-dollar -->
        <mat-icon class="mat-18" class="material-icons-outlined">money</mat-icon>

        {{order.total | currency:'â‚¦'}}
      </div>
      <div class="mt-2 flex items-center text-sm text-gray-500">
        <!-- Heroicon name: mini/calendar -->
        <mat-icon class="mat-18" class="material-icons-outlined">calendar_today</mat-icon>
          {{order.createdAt | date: 'medium'}}
      </div>

      <div class="mt-2 flex items-center text-sm text-green-500 cursor-pointer" (click)="exportPDF()">
        <!-- Heroicon name: mini/calendar -->
        <mat-icon class="mat-18" class="material-icons-outlined">print</mat-icon>
         Export Order
      </div>
    </div>
  </div>
  <ng-container *ngIf="order.category == 'New'; else statusControl">
    <div class="mt-5 flex lg:mt-0 lg:ml-4">
      <span class="ml-3 hidden sm:block">
        <button type="button" (click)="cancelOrder(order)" [disabled]="isCanceling"
          class="inline-flex items-center rounded-md border border-red-500 bg-white px-4 py-2 text-sm font-medium text-red-500 shadow-sm hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2">
          <mat-icon class="mat-18" *ngIf="!isCanceling">close</mat-icon>
          {{isCanceling ? 'CANCELLING....' : 'CANCEL ORDER'}}
        </button>
      </span>

      <span class="sm:ml-3">
        <button type="button" (click)="accept(order)"
          class="inline-flex items-center rounded-md border border-transparent bg-green-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
          <mat-icon class="mat-18" *ngIf="!isAccepting">check</mat-icon>
          {{isAccepting ? 'ACCEPTING....' : 'ACCEPT ORDER'}}
        </button>
      </span>


    </div>
  </ng-container>

  <ng-template #statusControl>
    <div class="mt-5 flex lg:mt-0 lg:ml-4">
      <mat-form-field appearance="outline" class="mx-5">
        <mat-label>Payment Status</mat-label>
        <mat-select  (selectionChange)="updatePaymentStatus(order, $event)" [(ngModel)]="order.paymentStatus">
          <mat-option *ngFor="let status of ['Paid', 'Unpaid']" [value]="status">{{status}}</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Order Status</mat-label>
        <mat-select  (selectionChange)="updateStatus($event, order)" [(ngModel)]="order.status[0].name" [compareWith]="compareFn">
          <mat-option *ngFor="let status of statuses" [value]="status">{{status.name}}</mat-option>
        </mat-select>
      </mat-form-field>
      <!-- <span class="ml-3 hidden sm:block">
        <button type="button" (click)="cancelOrder(order)" [disabled]="isCanceling"
          class="inline-flex items-center rounded-md border border-red-500 bg-white px-4 py-2 text-sm font-medium text-red-500 shadow-sm hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2">
          
          <mat-icon class="mat-18" *ngIf="!isCanceling">close</mat-icon>
          {{isCanceling ? 'CANCELLING....' : 'CANCEL ORDER'}}
        </button>
      </span>

      <span class="sm:ml-3">
        <button type="button" (click)="accept(order)"
          class="inline-flex items-center rounded-md border border-transparent bg-green-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
          
          <mat-icon class="mat-18" *ngIf="!isAccepting">check</mat-icon>
          {{isAccepting ? 'ACCEPTING....' : 'ACCEPT ORDER'}}
        </button>
      </span> -->


    </div>
  </ng-template>

</div>



<!-- <div fxLayout="row" fxLayoutAlign="space-between start" >
    <div fxLayout="row" fxLayoutAlign="start start" >
        <button mat-icon-button  fxFlexAlign="start">
            <mat-icon class="mat-18">arrow_back_ios</mat-icon>
        </button>
        <div fxLayout="column" fxLayoutAlign="start start" >
            <h1 class="text-3xl" style="font-size: 1.875rem;">Order ID #5552351</h1>
        </div>
  </div>

    <div fxLayout="row" fxLayoutAlign="start start" fxLayoutGap="20px">
        <button mat-stroked-button color="warn">CANCEL ORDER</button>
        <button mat-raised-button class="bg-green-600 text-white p-3">DELIVERED</button>
        
    </div>

</div> -->

<div fxLayout="row" fxLayoutAlign="space-between start" class="mt-10" fxLayoutGap="20px">
  <div fxLayout="column" fxLayoutAlign="space-between start" fxFlex="30%" fxLayoutGap="20px">
    <div class="mat-elevation-z2  rounded-md w-full" fxLayout="column" fxLayoutAlign="start start">

      <div fxLayout="column" fxLayoutAlign="space-around center" class="w-full p-3">
        <img src="https://davur.dexignzone.com/react/demo/static/media/1.7c3d5aa9.jpg" width="150" height="150"
          class="rounded-full">
        <h2 class="text-center font-bolder">{{order.user.name}}</h2>

        <button type="button"
          class="inline-flex items-center rounded-md border border-transparent bg-green-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
          Customer
        </button>
      </div>

      <mat-list class="w-full">

        <mat-list-item>
          <mat-icon matListIcon class="material-icons-outlined">call</mat-icon>{{order.user.phoneNumber}}
        </mat-list-item>
        <mat-divider></mat-divider>
        <mat-list-item>
          <mat-icon matListIcon class="material-icons-outlined">location_on</mat-icon>
          {{order.shipping.name + ' ' + order.shipping.administrativeArea + ' ' + order.shipping.locality }}
        </mat-list-item>
        <mat-divider></mat-divider>
        <div mat-subheader>Order Note</div>
        <mat-list-item>
          <p>{{order.orderInstruction || 'No Notes'}} </p>
        </mat-list-item>

      </mat-list>


    </div>

    <div class="mat-elevation-z2  rounded-md w-full">
      <div fxLayout="column" fxLayoutAlign="space-around center" class="w-full p-3">
        <img [src]="order.store.logo" width="150" height="150" class="rounded-full">
        <h2 class="text-center font-bolder">{{order.store.name}}</h2>

        <button type="button"
          class="inline-flex items-center rounded-md border border-transparent bg-green-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
          Restaurant
        </button>
      </div>

      <mat-list class="w-full">

        <mat-list-item>
          <mat-icon matListIcon class="material-icons-outlined">call</mat-icon>{{order.store.contactInfo.phone}}
        </mat-list-item>
        <mat-divider></mat-divider>
        <mat-list-item>
          <mat-icon matListIcon class="material-icons-outlined">mail</mat-icon>{{order.store.contactInfo.email}}
        </mat-list-item>
        <mat-divider></mat-divider>
        <mat-list-item>
          <mat-icon matListIcon class="material-icons-outlined">location_on</mat-icon>
          {{order.store.contactInfo.placeNumber + ' ' + order.store.contactInfo.placeName + ' ' +
          order.store.contactInfo.address || "No Address"}}
        </mat-list-item>
        <mat-divider></mat-divider>


      </mat-list>
    </div>
  </div>

  <div fxFlex="70%" fxLayoutGap="20px">
    <div class="mat-elevation-z2 p-3 rounded-md w-full" id="pdfTable" #pdfTable>
      <div class="p-3">
        <div class="overflow-x-auto">
          <table class="table-auto w-full">
            <thead class="text-xs font-semibold uppercase text-gray-400 bg-gray-50">
              <tr>
                <th class="p-2 whitespace-nowrap">
                  <div class="font-semibold text-left">Items</div>
                </th>
                <th class="p-2 whitespace-nowrap">
                  <div class="font-semibold text-left"> Qty</div>
                </th>
                <th class="p-2 whitespace-nowrap">
                  <div class="font-semibold text-left">Price</div>
                </th>
                <th class="p-2 whitespace-nowrap">
                  <div class="font-semibold text-left">Total Price</div>
                </th>
                <th class="p-2 whitespace-nowrap">
                  <div class="font-semibold text-center">Action</div>
                </th>
              </tr>
            </thead>
            <tbody class="text-sm divide-y divide-gray-100">
              <tr *ngFor="let item of order.cart.products">
                <td class="p-2 whitespace-nowrap">
                  <div class="flex items-center">
                    <div class="w-10 h-10 flex-shrink-0 mr-2 sm:mr-3">
                      <!-- <img class="rounded-lg" [src]="item.photos[0]" width="100" height="100" alt="Alex Shatov"> -->
                    </div>
                    <div fxLayout="column" fxLayoutAlign="start start">
                     
                      <div class="font-medium  text-blue-800">{{item.name}}</div>
                      <div fxLayout="column" fxLayoutAlign="space-around start">
                        <div class="font-medium text-gray-800" *ngFor="let option of item.options">
                          {{option.quantity}} x {{option.name}} = {{option.quantity * option.price | currency: order.store.currency}}
                        </div>
                      </div>


                    </div>

                  </div>
                </td>
                <td class="p-2 whitespace-nowrap">
                  <div class="text-left">{{item.quantity}}</div>
                </td>



                <td class="p-2 whitespace-nowrap">
                  <div class="text-left font-medium text-black">{{(item.price + optionsPrice(item.options)) | currency: order.store.currency}}</div>
                </td>
                <td class="p-2 whitespace-nowrap">
                  <div class="text-left font-medium text-black">{{ (item.price + optionsPrice(item.options)) *
                    item.quantity | currency: order.store.currency}}</div>
                </td>
                <td class="p-2 whitespace-nowrap">
                  <div class="text-lg text-center">
                    <button mat-icon-button color="warm">
                      <mat-icon class="mat-18">delete</mat-icon>
                    </button>
                  </div>
                </td>
              </tr>

              <tr>

                <td class="p-2 whitespace-nowrap">
                  <div class="text-left font-bold">Service Fee</div>
                </td>

                <td class="p-2 whitespace-nowrap">
                  <div class="text-left">-</div>
                </td>
                <td class="p-2 whitespace-nowrap">
                  <div class="text-left font-medium text-black">-</div>
                </td>
                <td class="p-2 whitespace-nowrap">
                  <div class="text-left font-medium text-black">{{order.serviceFee | currency: order.store.currency}}</div>
                </td>
                <td class="p-2 whitespace-nowrap">
                  <div class="text-lg text-center">
                    -
                  </div>
                </td>
              </tr>

              <tr>

                <td class="p-2 whitespace-nowrap">
                  <div class="text-left font-bold">Shipping Fee</div>
                </td>

                <td class="p-2 whitespace-nowrap">
                  <div class="text-left">-</div>
                </td>
                <td class="p-2 whitespace-nowrap">
                  <div class="text-left font-medium text-red-500">-</div>
                </td>
                <td class="p-2 whitespace-nowrap">
                  <div class="text-left font-medium text-red-500">{{order.shippingFee | currency: order.store.currency}}</div>
                </td>
                <td class="p-2 whitespace-nowrap">
                  <div class="text-lg text-center">
                    -
                  </div>
                </td>
              </tr>

              <tr>

                <td class="p-2 whitespace-nowrap">
                  <div class="text-left font-bold">Discount</div>
                </td>

                <td class="p-2 whitespace-nowrap">
                  <div class="text-left">-</div>
                </td>
                <td class="p-2 whitespace-nowrap">
                  <div class="text-left font-medium text-black">-</div>
                </td>
                <td class="p-2 whitespace-nowrap">
                  <div class="text-left font-medium text-black">{{order.discount | currency: order.store.currency}}</div>
                </td>
                <td class="p-2 whitespace-nowrap">
                  <div class="text-lg text-center">
                    -
                  </div>
                </td>
              </tr>

            </tbody>
            <tfoot class="bg-gray-700">
              <tr class="font-semibold text-white dark:white">
                <th scope="row" class="py-3 px-6 whitespace-nowrap text-base">
                  <div class="text-left font-bold">Total</div>
                </th>
                <td class="p-2 whitespace-nowrap">
                  <div class="text-left">-</div>
                </td>
                <td class="p-2 whitespace-nowrap">
                  <div class="text-left font-medium text-white">-</div>
                </td>
                <td class="p-2 whitespace-nowrap">
                  <div class="text-left font-medium text-white">
                    {{order.total | currency: order.store.currency}}
                  </div>
                </td>
                <td class="p-2 whitespace-nowrap">
                  <div class="text-lg text-center">
                    -
                  </div>
                </td>
              </tr>
            </tfoot>
          </table>
        </div>
      </div>
    </div>

    <div class="mat-elevation-z2 p-3 rounded-md w-full mt-5">
      <div class="p-3">

        <ol class="items-center sm:flex">
          <li class="relative mb-6 sm:mb-0">
            <div class="flex items-center">
              <div
                class="flex z-10 justify-center items-center w-6 h-6 bg-blue-200 rounded-full ring-0 ring-white dark:bg-blue-900 sm:ring-8 dark:ring-gray-900 shrink-0">
                <svg aria-hidden="true" class="w-3 h-3 text-blue-600 dark:text-blue-300" fill="currentColor"
                  viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd"
                    d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z"
                    clip-rule="evenodd"></path>
                </svg>
              </div>
              <div class="hidden sm:flex w-full bg-gray-200 h-0.5 dark:bg-gray-700"></div>
            </div>
            <div class="mt-3 sm:pr-8">
              <h3 class="text-lg font-semibold">Order Created</h3>
              <time
                class="block mb-2 text-sm font-normal leading-none text-gray-400 dark:text-gray-500">{{order.createdAt
                | date: 'medium'}}</time>
              <!-- <p class="text-base font-normal text-gray-500 dark:text-gray-400">Alex Onozor has Created an Order</p> -->
            </div>
          </li>
          <li class="relative mb-6 sm:mb-0" *ngFor="let status of order.status">
            <div class="flex items-center">
              <div
                class="flex z-10 justify-center items-center w-6 h-6 bg-blue-200 rounded-full ring-0 ring-white dark:bg-blue-900 sm:ring-8 dark:ring-gray-900 shrink-0">
                <svg aria-hidden="true" class="w-3 h-3 text-blue-600 dark:text-blue-300" fill="currentColor"
                  viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd"
                    d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z"
                    clip-rule="evenodd"></path>
                </svg>
              </div>
              <div class="hidden sm:flex w-full bg-gray-200 h-0.5 dark:bg-gray-700"></div>
            </div>
            <div class="mt-3 sm:pr-8">
              <h3 [class]="'text-lg font-semibold ' + status.color">{{status.name}}</h3>
              <time
                class="block mb-2 text-sm font-normal leading-none text-gray-400 dark:text-gray-500">{{status?.updatedOn
                | date: 'medium'}}</time>
              <!-- <p class="text-base font-normal text-gray-500 dark:text-gray-400">Alex Onozor has Created an Order</p> -->
            </div>
          </li>
        </ol>

      </div>
    </div>

  </div>
</div>