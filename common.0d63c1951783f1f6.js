"use strict";(self.webpackChunkshopbot=self.webpackChunkshopbot||[]).push([[592],{4382:(f,d,s)=>{s.d(d,{D:()=>U});var a=s(3075),_=s(2349),u=s(1159),e=s(5e3),n=s(2152),m=s(9808),i=s(508),h=s(7423),g=s(6688),C=s(7322),E=s(5245),M=s(7531),T=s(4107),v=s(7093);function O(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"mat-chip",18),e.NdJ("removed",function(){const p=e.CHM(t).$implicit,x=e.oxw(2);return e.KtG(x.remove(p))}),e._uU(1),e.TgZ(2,"button",19)(3,"mat-icon"),e._uU(4,"cancel"),e.qZA()()()}if(2&r){const t=l.$implicit;e.xp6(1),e.hij(" ",t.value.name," ")}}function P(r,l){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-form-field",13)(2,"mat-label"),e._uU(3,"Recipients"),e.qZA(),e.TgZ(4,"mat-chip-list",14,15),e.YNc(6,O,5,1,"mat-chip",16),e.TgZ(7,"input",17),e.NdJ("matChipInputTokenEnd",function(c){e.CHM(t);const p=e.oxw();return e.KtG(p.add(c))}),e.qZA()()(),e.BQk()}if(2&r){const t=e.MAs(5),o=e.oxw();e.xp6(6),e.Q6J("ngForOf",o.recipients.controls),e.xp6(1),e.Q6J("matChipInputFor",t)("matChipInputSeparatorKeyCodes",o.separatorKeysCodes)("matChipInputAddOnBlur",o.addOnBlur)}}function D(r,l){if(1&r&&(e.TgZ(0,"mat-option",21),e._uU(1),e.qZA()),2&r){const t=l.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}const A=function(){return["Registered Customers","Unregistered Customers","Both"]};function I(r,l){1&r&&(e.TgZ(0,"mat-form-field")(1,"mat-label"),e._uU(2,"Select Recipients"),e.qZA(),e.TgZ(3,"mat-select",20),e.YNc(4,D,2,2,"mat-option",8),e.qZA()()),2&r&&(e.xp6(4),e.Q6J("ngForOf",e.DdM(1,A)))}function R(r,l){if(1&r&&(e.TgZ(0,"mat-option",21),e._uU(1),e.qZA()),2&r){const t=l.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}const Z=function(){return["Notification","Email","Both"]};let U=(()=>{class r{constructor(t,o,c,p){this.fb=t,this.notificationsService=o,this.dialogRef=c,this.data=p,this.messagesForm=this.fb.group({title:["",a.kI.required],body:["",a.kI.required],recipients:this.fb.array([]),type:["",a.kI.required],recipientsType:[""]}),this.addOnBlur=!0,this.separatorKeysCodes=[u.K5,u.OC],this.recipientsData=[]}ngOnInit(){this.data.allCustomers||(this.data.isBulkMsg?(this.recipientsData=this.data.customers,this.recipientsData.forEach(t=>{t.phoneCredentials.length>0&&this.addRecipients(t)})):(this.recipientsData.push(this.data.customers),this.recipientsData.map(t=>this.addRecipients(t))))}get recipients(){return this.messagesForm.controls.recipients}addRecipients(t){const o=this.fb.group({name:[t.name],id:[t._id],phoneToken:[t.phoneCredentials]});this.recipients.push(o)}deleteRecipient(t){this.recipients.removeAt(t)}submit(){this.notificationsService.createNotification(this.messagesForm.getRawValue()).subscribe(t=>{this.dialogRef.close(t)})}add(t){const o=(t.value||"").trim();o&&this.recipientsData.push({name:o}),t.chipInput.clear()}remove(t){const o=this.recipientsData.indexOf(t);o>=0&&this.recipientsData.splice(o,1)}edit(t,o){const c=o.value.trim();if(!c)return void this.remove(t);const p=this.recipientsData.indexOf(t);p>0&&(this.recipientsData[p].name=c)}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(a.qu),e.Y36(n.T),e.Y36(_.so),e.Y36(_.WI))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-create-messages"]],decls:25,vars:7,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["fxLayout","column","fxLayoutAlign","space-around stretch",3,"formGroup"],[4,"ngIf","ngIfElse"],["selectRecipient",""],["appearance","fill"],["matInput","","placeholder","Enter Message Title","formControlName","title"],["formControlName","type"],[3,"value",4,"ngFor","ngForOf"],["matInput","","placeholder","Enter Message Body","rows","20","formControlName","body"],["mat-dialog-actions",""],["mat-button","",3,"mat-dialog-close"],["mat-button","","cdkFocusInitial","",3,"disabled","click"],["appearance","fill",1,"example-chip-list"],["aria-label","Fruit selection","formArrayName","recipients"],["chipList",""],[3,"removed",4,"ngFor","ngForOf"],[3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],[3,"removed"],["matChipRemove",""],["formControlName","recipientsType"],[3,"value"]],template:function(t,o){if(1&t&&(e.TgZ(0,"h1",0),e._uU(1,"Send Notification"),e.qZA(),e.TgZ(2,"div",1)(3,"form",2),e.YNc(4,P,8,4,"ng-container",3),e.YNc(5,I,5,2,"ng-template",null,4,e.W1O),e.TgZ(7,"mat-form-field",5)(8,"mat-label"),e._uU(9,"Title"),e.qZA(),e._UZ(10,"input",6),e.qZA(),e.TgZ(11,"mat-form-field",5)(12,"mat-label"),e._uU(13,"Select Message Type"),e.qZA(),e.TgZ(14,"mat-select",7),e.YNc(15,R,2,2,"mat-option",8),e.qZA()(),e.TgZ(16,"mat-form-field",5)(17,"mat-label"),e._uU(18,"body"),e.qZA(),e._UZ(19,"textarea",9),e.qZA()()(),e.TgZ(20,"div",10)(21,"button",11),e._uU(22,"Cancel"),e.qZA(),e.TgZ(23,"button",12),e.NdJ("click",function(){return o.submit()}),e._uU(24,"Send"),e.qZA()()),2&t){const c=e.MAs(6);e.xp6(3),e.Q6J("formGroup",o.messagesForm),e.xp6(1),e.Q6J("ngIf",!o.data.allCustomers)("ngIfElse",c),e.xp6(11),e.Q6J("ngForOf",e.DdM(6,Z)),e.xp6(6),e.Q6J("mat-dialog-close",null),e.xp6(2),e.Q6J("disabled",o.messagesForm.invalid)}},dependencies:[m.sg,m.O5,i.ey,h.lW,g.qn,g.HS,g.oH,g.qH,C.KE,C.hX,E.Hw,M.Nt,T.gD,_.ZT,_.uh,_.xY,_.H8,v.xw,v.Wh,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,a.CE]}),r})()},3475:(f,d,s)=>{s.d(d,{T:()=>u,f:()=>e});var a=s(5e3),_=s(6614);let u=(()=>{class n{constructor(i){this.permissionService=i}resolve(){return this.permissionService.getPermissions()}}return n.\u0275fac=function(i){return new(i||n)(a.LFG(_.$))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),e=(()=>{class n{constructor(i){this.permissionService=i}resolve(i){const h=i.paramMap.get("id");return this.permissionService.getPermission(h)}}return n.\u0275fac=function(i){return new(i||n)(a.LFG(_.$))},n.\u0275prov=a.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()},6614:(f,d,s)=>{s.d(d,{$:()=>e});var a=s(2340),_=s(5e3),u=s(520);let e=(()=>{class n{constructor(i){this._httpClient=i,this.hostServer=a.N.hostServer}createPermission(i){return this._httpClient.post(`${this.hostServer}/roles`,i)}getPermissions(){return this._httpClient.get(`${this.hostServer}/roles`)}getPermission(i){return this._httpClient.get(`${this.hostServer}/roles/${i}`)}updatePermission(i,h){return this._httpClient.put(`${this.hostServer}/roles/${i}`,h)}deletePermission(i){return this._httpClient.delete(`${this.hostServer}/roles/${i}`)}}return n.\u0275fac=function(i){return new(i||n)(_.LFG(u.eN))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})()}}]);