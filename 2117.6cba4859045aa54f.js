"use strict";(self.webpackChunkshopbot=self.webpackChunkshopbot||[]).push([[2117],{2117:(st,v,a)=>{a.r(v),a.d(v,{PayoutsModule:()=>ot});var u=a(177),l=a(8498),t=a(4020);let _=(()=>{class n{constructor(){}ngOnInit(){}static{this.\u0275fac=function(o){return new(o||n)}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-payouts"]],decls:1,vars:0,template:function(o,i){1&o&&t.nrm(0,"router-outlet")},dependencies:[l.iI,l.n3],encapsulation:2})}}return n})();var y=a(6440),r=a(9159),x=a(5024),F=a(1269),h=a(9213),f=a(9115),m=a(8834),k=a(2765),D=a(5312),T=a(1626);let d=(()=>{class n{constructor(e){this._httpClient=e,this.hostServer=D.c.hostServer}createTransaction(e){return this._httpClient.post(`${this.hostServer}/transactions`,e)}undoTransaction(e){return this._httpClient.post(`${this.hostServer}/transactions/undo/transaction`,e)}getTransactions(){return this._httpClient.get(`${this.hostServer}/transactions`)}getTransaction(e){return this._httpClient.get(`${this.hostServer}/transactions/${e}`)}updateTransaction(e,o){return this._httpClient.put(`${this.hostServer}/transactions/${e}`,o)}deleteTransaction(e){return this._httpClient.delete(`${this.hostServer}/transactions/${e}`)}static{this.\u0275fac=function(o){return new(o||n)(t.KVO(T.Qq))}}static{this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac})}}return n})();var b=a(5351),$=a(5416);const I=()=>[15,30,60],E=n=>["../",n,"edit"];function L(n,s){if(1&n){const e=t.RV6();t.j41(0,"span",3)(1,"button",21),t.EFF(2),t.k0s(),t.j41(3,"button",22),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.deleteSelected())}),t.j41(4,"mat-icon",23),t.EFF(5,"delete"),t.k0s(),t.EFF(6," Delete Selected Fund Request"),t.k0s()()}if(2&n){const e=t.XpG();t.R7$(2),t.SpI("",e.selection.selected.length," Selected")}}function P(n,s){if(1&n){const e=t.RV6();t.j41(0,"th",24)(1,"mat-checkbox",25),t.bIt("change",function(i){t.eBV(e);const c=t.XpG();return t.Njj(i?c.toggleAllRows():null)}),t.k0s()()}if(2&n){const e=t.XpG();t.R7$(),t.Y8G("checked",e.selection.hasValue()&&e.isAllSelected())("indeterminate",e.selection.hasValue()&&!e.isAllSelected())("aria-label",e.checkboxLabel())}}function V(n,s){if(1&n){const e=t.RV6();t.j41(0,"td",26)(1,"mat-checkbox",27),t.bIt("click",function(i){return t.eBV(e),t.Njj(i.stopPropagation())})("change",function(i){const c=t.eBV(e).$implicit,p=t.XpG();return t.Njj(i?p.selection.toggle(c):null)}),t.k0s()()}if(2&n){const e=s.$implicit,o=t.XpG();t.R7$(),t.Y8G("checked",o.selection.isSelected(e))("aria-label",o.checkboxLabel(e))}}function w(n,s){1&n&&(t.j41(0,"th",24),t.EFF(1,"Created At"),t.k0s())}function G(n,s){if(1&n&&(t.j41(0,"td",26),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&n){const e=s.$implicit;t.R7$(),t.JRh(t.i5U(2,1,e.createdAt,"medium"))}}function A(n,s){1&n&&(t.j41(0,"th",24),t.EFF(1,"Vendor"),t.k0s())}function N(n,s){if(1&n&&(t.j41(0,"td",26),t.EFF(1),t.k0s()),2&n){const e=s.$implicit;t.R7$(),t.JRh(e.store.name)}}function X(n,s){1&n&&(t.j41(0,"th",24),t.EFF(1,"Number of orders"),t.k0s())}function B(n,s){if(1&n&&(t.j41(0,"td",26),t.EFF(1),t.k0s()),2&n){const e=s.$implicit;t.R7$(),t.JRh(e.orders.length)}}function M(n,s){1&n&&(t.j41(0,"th",24),t.EFF(1,"Type"),t.k0s())}function U(n,s){if(1&n&&(t.j41(0,"td",26),t.EFF(1),t.k0s()),2&n){const e=s.$implicit;t.R7$(),t.SpI(" ",e.transactionType||"Credit","")}}function Y(n,s){1&n&&(t.j41(0,"th",24),t.EFF(1,"Remarks"),t.k0s())}function O(n,s){if(1&n&&(t.j41(0,"td",26),t.EFF(1),t.k0s()),2&n){const e=s.$implicit;t.R7$(),t.SpI(" ",e.remark||"Payout","")}}function H(n,s){1&n&&(t.j41(0,"th",24),t.EFF(1,"Total"),t.k0s())}function z(n,s){if(1&n&&(t.j41(0,"td",26),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&n){const e=s.$implicit;t.R7$(),t.JRh(t.i5U(2,1,e.totalAmount,e.store.currency))}}function K(n,s){1&n&&(t.j41(0,"th",24),t.EFF(1,"Actions"),t.k0s())}function J(n,s){if(1&n){const e=t.RV6();t.j41(0,"td",26)(1,"button",28),t.bIt("click",function(i){return t.eBV(e),t.Njj(i.stopPropagation())}),t.j41(2,"mat-icon"),t.EFF(3,"more_vert"),t.k0s()(),t.j41(4,"mat-menu",null,0)(6,"button",29),t.bIt("click",function(){const i=t.eBV(e),c=i.$implicit,p=i.index,it=t.XpG();return t.Njj(it.deleteTransaction(c._id,p))}),t.j41(7,"mat-icon",30),t.EFF(8,"delete"),t.k0s(),t.j41(9,"span"),t.EFF(10,"Delete"),t.k0s()(),t.j41(11,"button",31)(12,"mat-icon",30),t.EFF(13,"visibility"),t.k0s(),t.j41(14,"span"),t.EFF(15,"View Request"),t.k0s()(),t.j41(16,"button",29),t.bIt("click",function(){const i=t.eBV(e).$implicit,c=t.XpG();return t.Njj(c.undoTransaction(i))}),t.j41(17,"mat-icon",30),t.EFF(18,"undo"),t.k0s(),t.j41(19,"span"),t.EFF(20,"Undo Transaction"),t.k0s()()()()}if(2&n){const e=s.$implicit,o=t.sdS(5);t.R7$(),t.Y8G("matMenuTriggerFor",o),t.R7$(10),t.Y8G("routerLink",t.eq3(2,E,e._id))}}function Z(n,s){1&n&&t.nrm(0,"tr",32)}function Q(n,s){if(1&n){const e=t.RV6();t.j41(0,"tr",33),t.bIt("click",function(){const i=t.eBV(e).$implicit,c=t.XpG();return t.Njj(c.openModal(i._id))}),t.k0s()}}let C=(()=>{class n{constructor(e,o,i,c,p){this.route=e,this.transactionsService=o,this._matDialog=i,this.router=c,this.snackBar=p,this.displayedColumns=["select","createdAt","vendor","orders","type","remark","total","actions"],this.dataSource=new r.I6([]),this.selection=new x.CB(!0,[])}ngAfterViewInit(){this.dataSource.paginator=this.paginator}ngOnInit(){this.dataSource=new r.I6(this.route.snapshot.data.transactions)}openModal(e){this.router.navigate(["dashboard","reports","payouts",e,"details"])}isAllSelected(){return this.selection.selected.length===this.dataSource.data.length}toggleAllRows(){this.isAllSelected()?this.selection.clear():this.selection.select(...this.dataSource.data)}undoTransaction(e){this.confirmDialogRef=this._matDialog.open(F.Y,{disableClose:!1}),this.confirmDialogRef.componentInstance.title="Undo transaction?",this.confirmDialogRef.componentInstance.confirmMessage="Are you sure you want to undo this transaction?",this.confirmDialogRef.componentInstance.confirmButton="Undo",this.confirmDialogRef.afterClosed().subscribe(o=>{this.transactionsService.undoTransaction(e).subscribe(i=>{this.snackBar.open("Transaction has been undone","okay",{duration:3e3})})})}deleteSelected(){this.confirmDialogRef=this._matDialog.open(F.Y,{disableClose:!1}),this.confirmDialogRef.componentInstance.title="Delete Fund Request?",this.confirmDialogRef.componentInstance.confirmMessage="Are you sure you want to delete these Fund Request?",this.confirmDialogRef.componentInstance.confirmButton="Delete",this.confirmDialogRef.afterClosed().subscribe(e=>{e&&this.selection.selected.forEach((o,i)=>{this.dataSource.data.splice(i,1),this.dataSource=new r.I6(this.dataSource.data),this.dataSource._updateChangeSubscription(),this.dataSource.paginator=this.paginator,this.transactionsService.deleteTransaction(o._id).subscribe()})})}checkboxLabel(e){return e?`${this.selection.isSelected(e)?"deselect":"select"} row ${e.position+1}`:(this.isAllSelected()?"deselect":"select")+" all"}deleteTransaction(e,o){this.confirmDialogRef=this._matDialog.open(F.Y,{disableClose:!1}),this.confirmDialogRef.componentInstance.title="Delete Fund Requests?",this.confirmDialogRef.componentInstance.confirmMessage="Are you sure you want to delete this Fund Requests?",this.confirmDialogRef.componentInstance.confirmButton="Delete",this.confirmDialogRef.afterClosed().subscribe(i=>{i&&(this.dataSource.data.splice(o,1),this.dataSource=new r.I6(this.dataSource.data),this.dataSource._updateChangeSubscription(),this.dataSource.paginator=this.paginator,this.transactionsService.deleteTransaction(e).subscribe())})}update(e,o){this.transactionsService.updateTransaction(e,{enabled:o.checked}).subscribe(i=>{})}static{this.\u0275fac=function(o){return new(o||n)(t.rXU(l.nX),t.rXU(d),t.rXU(b.bZ),t.rXU(l.Ix),t.rXU($.UG))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-payouts-list"]],viewQuery:function(o,i){if(1&o&&t.GBs(y.iy,5),2&o){let c;t.mGM(c=t.lsd())&&(i.paginator=c.first)}},decls:35,vars:6,consts:[["menu","matMenu"],[1,"h-screen","w-full"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","start center",1,"card","bg-white","w-full","mat-elevation-z2","px-2","py-2"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","10px",1,"text-lg","font-thin"],[1,"text-2xl"],["class","text-lg font-thin","fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","10px",4,"ngIf"],[1,"mat-elevation-z8"],["mat-table","",1,"w-full",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","createdAt"],["matColumnDef","vendor"],["matColumnDef","orders"],["matColumnDef","type"],["matColumnDef","remark"],["matColumnDef","total"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","cursor-pointer",3,"click",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page of periodic elements",3,"pageSizeOptions"],["mat-button",""],["mat-stroked-button","","color","warn",3,"click"],[1,"mat-18"],["mat-header-cell",""],[3,"change","checked","indeterminate","aria-label"],["mat-cell",""],[3,"click","change","checked","aria-label"],["mat-icon-button","","aria-label","Example icon-button with a menu",3,"click","matMenuTriggerFor"],["mat-menu-item","",3,"click"],[1,"material-icons-outlined"],["mat-menu-item","",3,"routerLink"],["mat-header-row",""],["mat-row","",1,"cursor-pointer",3,"click"]],template:function(o,i){1&o&&(t.j41(0,"div",1)(1,"div",2)(2,"span",3)(3,"span",4),t.EFF(4,"Payout Settlement"),t.k0s()(),t.DNE(5,L,7,1,"span",5),t.k0s(),t.j41(6,"div",6)(7,"table",7),t.qex(8,8),t.DNE(9,P,2,3,"th",9)(10,V,2,2,"td",10),t.bVm(),t.qex(11,11),t.DNE(12,w,2,0,"th",9)(13,G,3,4,"td",10),t.bVm(),t.qex(14,12),t.DNE(15,A,2,0,"th",9)(16,N,2,1,"td",10),t.bVm(),t.qex(17,13),t.DNE(18,X,2,0,"th",9)(19,B,2,1,"td",10),t.bVm(),t.qex(20,14),t.DNE(21,M,2,0,"th",9)(22,U,2,1,"td",10),t.bVm(),t.qex(23,15),t.DNE(24,Y,2,0,"th",9)(25,O,2,1,"td",10),t.bVm(),t.qex(26,16),t.DNE(27,H,2,0,"th",9)(28,z,3,4,"td",10),t.bVm(),t.qex(29,17),t.DNE(30,K,2,0,"th",9)(31,J,21,4,"td",10),t.bVm(),t.DNE(32,Z,1,0,"tr",18)(33,Q,1,0,"tr",19),t.k0s(),t.nrm(34,"mat-paginator",20),t.k0s()()),2&o&&(t.R7$(5),t.Y8G("ngIf",i.selection.selected.length),t.R7$(2),t.Y8G("dataSource",i.dataSource),t.R7$(25),t.Y8G("matHeaderRowDef",i.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",i.displayedColumns),t.R7$(),t.Y8G("pageSizeOptions",t.lJ4(5,I)))},dependencies:[u.MD,u.bT,u.oe,u.vh,r.tP,r.Zl,r.tL,r.ji,r.cC,r.YV,r.iL,r.KS,r.$R,r.YZ,r.NB,h.m_,h.An,f.Cn,f.kk,f.fb,f.Cp,m.Hl,m.$z,m.iY,l.iI,l.Wk,y.Ou,y.iy,k.g7,k.So],encapsulation:2})}}return n})(),j=(()=>{class n{constructor(e){this.transactionsService=e}resolve(){return this.transactionsService.getTransactions()}static{this.\u0275fac=function(o){return new(o||n)(t.KVO(d))}}static{this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),S=(()=>{class n{constructor(e){this.transactionService=e}resolve(e){const o=e.paramMap.get("id");return this.transactionService.getTransaction(o)}static{this.\u0275fac=function(o){return new(o||n)(t.KVO(d))}}static{this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function W(n,s){if(1&n){const e=t.RV6();t.j41(0,"li",13),t.bIt("click",function(){const i=t.eBV(e).$implicit,c=t.XpG();return t.Njj(c.goToOrder(i._id))}),t.j41(1,"div",6)(2,"div",7)(3,"p",8),t.EFF(4),t.k0s()(),t.j41(5,"div",7)(6,"p",8),t.EFF(7),t.nI1(8,"date"),t.k0s()(),t.j41(9,"div",9),t.EFF(10),t.nI1(11,"currency"),t.k0s()()()}if(2&n){const e=s.$implicit,o=t.XpG();t.R7$(4),t.SpI(" ",e.payment," "),t.R7$(3),t.SpI(" ",t.i5U(8,3,e.createdAt,"meduim")," "),t.R7$(3),t.SpI(" ",t.i5U(11,6,e.total-e.serviceFee-e.shippingFee-(e.total-e.serviceFee-e.shippingFee)/100*e.vendorCommission,o.transaction.store.currency)," ")}}let g=(()=>{class n{constructor(e,o,i){this.route=e,this.transactionsService=o,this.router=i,this.transaction=this.route.snapshot.data.transaction}ngOnInit(){}closeModal(){this.router.navigate(["dashboard","reports","payouts","list"])}goToOrder(e){this.router.navigate(["dashboard","orders",e,"details"])}static{this.\u0275fac=function(o){return new(o||n)(t.rXU(l.nX),t.rXU(d),t.rXU(l.Ix))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-payouts-details"]],decls:49,vars:11,consts:[[1,"mat-elevation-z8","container","mx-auto","my-10","p-5",2,"width","40rem"],["fxLayout","row","fxLayoutAlign","space-between center",1,"mb-3"],[1,"text-slate-500"],["mat-icon-button","",3,"click"],[1,"divide-y","w-full","divide-gray-200"],[1,"pb-3","sm:pb-4"],[1,"flex","items-center","space-x-4"],[1,"flex-1","min-w-0"],[1,"text-sm","font-medium","text-gray-900","truncate"],[1,"inline-flex","items-center","text-base","font-semibold","text-gray-900"],[1,"py-3","sm:py-4"],[1,"divide-y","w-full","divide-gray-100"],["class","py-3 sm:py-4 hover:bg-slate-300 cursor-pointer",3,"click",4,"ngFor","ngForOf"],[1,"py-3","sm:py-4","hover:bg-slate-300","cursor-pointer",3,"click"]],template:function(o,i){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"h3",2),t.EFF(3,"Settlement information"),t.k0s(),t.j41(4,"button",3),t.bIt("click",function(){return i.closeModal()}),t.j41(5,"mat-icon"),t.EFF(6,"close"),t.k0s()()(),t.j41(7,"ul",4)(8,"li",5)(9,"div",6)(10,"div",7)(11,"p",8),t.EFF(12," Reference "),t.k0s()(),t.j41(13,"div",9),t.EFF(14),t.k0s()()(),t.j41(15,"li",10)(16,"div",6)(17,"div",7)(18,"p",8),t.EFF(19," Store / Vendor "),t.k0s()(),t.j41(20,"div",9),t.EFF(21),t.k0s()()(),t.j41(22,"li",10)(23,"div",6)(24,"div",7)(25,"p",8),t.EFF(26," Created "),t.k0s()(),t.j41(27,"div",9),t.EFF(28),t.nI1(29,"date"),t.k0s()()(),t.j41(30,"li",10)(31,"div",6)(32,"div",7)(33,"p",8),t.EFF(34," Status "),t.k0s()(),t.j41(35,"div",9),t.EFF(36),t.k0s()()(),t.j41(37,"li",10)(38,"div",6)(39,"div",7)(40,"p",8),t.EFF(41," Fee "),t.k0s()(),t.j41(42,"div",9),t.EFF(43),t.nI1(44,"currency"),t.k0s()()()(),t.j41(45,"h3",2),t.EFF(46,"Orders that make up this settlement"),t.k0s(),t.j41(47,"ul",11),t.DNE(48,W,12,9,"li",12),t.k0s()()),2&o&&(t.R7$(14),t.SpI(" ",i.transaction.reference," "),t.R7$(7),t.SpI(" ",i.transaction.store.name," "),t.R7$(7),t.SpI(" ",t.bMT(29,6,i.transaction.createdAt)," "),t.R7$(8),t.SpI(" ",i.transaction.status," "),t.R7$(7),t.SpI(" ",t.i5U(44,8,i.transaction.totalAmount,i.transaction.store.currency)," "),t.R7$(5),t.Y8G("ngForOf",i.transaction.orders))},dependencies:[u.MD,u.Sq,u.oe,u.vh,h.m_,h.An,m.Hl,m.iY],encapsulation:2})}}return n})();const q=[{path:"",component:_,children:[{path:"list",component:C,resolve:{transactions:j}},{path:":id/details",component:g,resolve:{transaction:S}}]}];let tt=(()=>{class n{static{this.\u0275fac=function(o){return new(o||n)}}static{this.\u0275mod=t.$C({type:n})}static{this.\u0275inj=t.G2t({imports:[l.iI.forChild(q),l.iI]})}}return n})();var et=a(6924),R=a(9417);let nt=(()=>{class n{constructor(e,o){this.dialog=e,this.router=o}canActivate(e,o){const i=e.paramMap.get("id");return this.dialog.open(g,{data:{id:i}}),!1}static{this.\u0275fac=function(o){return new(o||n)(t.KVO(b.bZ),t.KVO(l.Ix))}}static{this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac})}}return n})(),ot=(()=>{class n{static{this.\u0275fac=function(o){return new(o||n)}}static{this.\u0275mod=t.$C({type:n})}static{this.\u0275inj=t.G2t({providers:[d,j,S,nt],imports:[u.MD,tt,et.YF,R.X1,R.YN,_,C,g]})}}return n})()}}]);