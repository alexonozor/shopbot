"use strict";(self.webpackChunkshopbot=self.webpackChunkshopbot||[]).push([[6840],{6840:(z,d,i)=>{i.r(d),i.d(d,{FinanceDetailsComponent:()=>Y});var g=i(8141),C=i(6440),E=i(2042),l=i(9159),F=i(29),_=i(5749),O=i(5024),M=i(1269),c=i(2643),f=i(7235),m=i(177),P=i(6924),u=i(9417),p=i(9213),h=i(8834),t=i(4020),T=i(5351),R=i(8498),D=i(2920);const b=["pdfTable"];function v(n,r){1&n&&(t.j41(0,"th",25),t.EFF(1," Order Number "),t.k0s())}function I(n,r){if(1&n&&(t.j41(0,"td",26),t.EFF(1),t.k0s()),2&n){const e=r.$implicit;t.R7$(),t.SpI(" ",e.reference," ")}}function S(n,r){1&n&&(t.j41(0,"td",27),t.EFF(1," Total"),t.k0s())}function y(n,r){1&n&&(t.j41(0,"th",25),t.EFF(1," Date "),t.k0s())}function x(n,r){if(1&n&&(t.j41(0,"td",26),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&n){const e=r.$implicit;t.R7$(),t.SpI(" ",t.i5U(2,1,e.createdAt,"MMM d, y, h:mm:ss a")," ")}}function A(n,r){1&n&&t.nrm(0,"td",28)}function U(n,r){1&n&&(t.j41(0,"th",25),t.EFF(1," Order Amount "),t.k0s())}function B(n,r){if(1&n&&(t.j41(0,"td",26),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&n){const e=r.$implicit,o=t.XpG();t.R7$(),t.SpI(" ",t.i5U(2,1,e.total,o.store.currency)," ")}}function j(n,r){if(1&n&&(t.j41(0,"td",27),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&n){const e=t.XpG();t.R7$(),t.SpI(" ",t.i5U(2,1,e.getTotalCost,e.store.currency)," ")}}function L(n,r){1&n&&(t.j41(0,"th",25),t.EFF(1," Shopbot Commission "),t.k0s())}function $(n,r){if(1&n&&(t.j41(0,"td",26),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&n){const e=r.$implicit,o=t.XpG();t.R7$(),t.SpI(" ",t.i5U(2,1,(null==e?null:e.total)*o.store.finance.adminCommission/100,o.store.currency)," ")}}function k(n,r){if(1&n&&(t.j41(0,"td",27),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&n){const e=t.XpG();t.R7$(),t.SpI(" ",t.i5U(2,1,e.getShopbotTotal,e.store.currency)," ")}}function W(n,r){1&n&&(t.j41(0,"th",25),t.EFF(1," Vendor Amount "),t.k0s())}function K(n,r){if(1&n&&(t.j41(0,"td",26),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&n){const e=r.$implicit,o=t.XpG();t.R7$(),t.SpI(" ",t.i5U(2,1,(null==e?null:e.total)-(null==e?null:e.total)*o.store.finance.adminCommission/100,o.store.currency)," ")}}function w(n,r){if(1&n&&(t.j41(0,"td",27),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&n){const e=t.XpG();t.R7$(),t.SpI(" ",t.i5U(2,1,e.getVendorCost,e.store.currency)," ")}}function V(n,r){1&n&&t.nrm(0,"tr",29)}function G(n,r){1&n&&t.nrm(0,"tr",30)}function X(n,r){1&n&&t.nrm(0,"tr",31)}const N=i(5680);c.vfs=f.vfs;let Y=(()=>{class n{constructor(e,o,a,s){this.socket=e,this.storeService=o,this._matDialog=a,this.route=s,this.displayedColumns=["reference","date","orderAmount","adminCommission","vendorEarning"],this.selection=new O.CB(!0,[]),this.store=this.route.parent?.parent?.snapshot.data.store,this.dataSource=new l.I6}compareFn(e,o){return e.name===o}isAllSelected(){return this.selection.selected.length===this.dataSource.data.length}toggleAllRows(){this.isAllSelected()?this.selection.clear():this.selection.select(...this.dataSource.data)}checkboxLabel(e){return e?`${this.selection.isSelected(e)?"deselect":"select"} row ${e.position+1}`:(this.isAllSelected()?"deselect":"select")+" all"}ngOnInit(){this.getOrders(),this.getOrder()}deleteOrder(e,o){this.confirmDialogRef=this._matDialog.open(M.Y,{disableClose:!1}),this.confirmDialogRef.componentInstance.title="Delete Item?",this.confirmDialogRef.componentInstance.confirmMessage="Are you sure you want to delete this order?",this.confirmDialogRef.componentInstance.confirmButton="Delete",this.confirmDialogRef.afterClosed().subscribe(a=>{a&&(this.dataSource.data.splice(e,1),this.dataSource._updateChangeSubscription(),this.storeService.deleteStoreOrders(o._id).subscribe())})}getOrders(){this.storeService.getStoreOrders(this.store._id).pipe((0,g.M)(e=>{this.dataSource=new l.I6(e)})).subscribe()}get getTotalCost(){return this.dataSource.data.map(e=>e.total).reduce((e,o)=>e+o,0)}get getVendorCost(){let e=0;for(const o of this.dataSource.data){let a=o.total-o.total*this.store.finance.adminCommission/100;console.log(a),e+=a}return e}get getShopbotTotal(){return this.getTotalCost-this.getVendorCost}print(){var o=N(this.pdfTable.nativeElement.innerHTML);c.createPdf({content:o,styles:{"with-margin":{marginBottom:5},amount:{marginBottom:5,bold:!0},fill:{marginBottom:5,bold:!0,fillColor:"green"}}}).download()}getOrder(){}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}applyFilter(e){this.dataSource.filter=e.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}changeValue(e,o){this.storeService.updateOrderStatus(o._id,o.user._id,e.value).subscribe(a=>{console.log(a)})}static{this.\u0275fac=function(o){return new(o||n)(t.rXU(F.yQ),t.rXU(_.n),t.rXU(T.bZ),t.rXU(R.nX))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-finance-details-tab"]],viewQuery:function(o,a){if(1&o&&(t.GBs(b,5),t.GBs(C.iy,5),t.GBs(E.B4,5)),2&o){let s;t.mGM(s=t.lsd())&&(a.pdfTable=s.first),t.mGM(s=t.lsd())&&(a.paginator=s.first),t.mGM(s=t.lsd())&&(a.sort=s.first)}},inputs:{store:"store"},features:[t.Jv_([_.n])],decls:63,vars:22,consts:[["pdfTable",""],[2,"padding","20px"],[1,"mat-elevation-z6","mb-3","p-3"],["mat-raised-button","","color","primary",3,"click"],["id","pdfTable",1,"mat-elevation-z6","example-container"],["fxLayout","row","fxLayoutAlign","center center"],[1,"grid","max-w-screen-xl","grid-cols-2","gap-8","p-4","mx-auto","sm:grid-cols-2","xl:grid-cols-4","sm:p-8"],[1,"flex","flex-col","items-center","justify-center","with-margin"],[1,"mb-2","text-3xl","font-extrabold","amount"],[1,"font-light","red"],[1,"font-light"],[1,"mb-2","text-3xl","font-extrabold","amount","fill"],["mat-table","","matSort","",1,"w-full",2,"width","100%",3,"dataSource"],["matColumnDef","reference"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-footer-cell","","class","font-bold",4,"matFooterCellDef"],["matColumnDef","date"],["mat-footer-cell","",4,"matFooterCellDef"],["matColumnDef","orderAmount"],["matColumnDef","adminCommission"],["matColumnDef","vendorEarning"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef","matFooterRowDefSticky"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-footer-cell","",1,"font-bold"],["mat-footer-cell",""],["mat-header-row",""],["mat-row",""],["mat-footer-row",""]],template:function(o,a){if(1&o){const s=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"button",3),t.bIt("click",function(){return t.eBV(s),t.Njj(a.print())}),t.j41(3,"mat-icon"),t.EFF(4,"print"),t.k0s(),t.EFF(5," Print"),t.k0s()(),t.j41(6,"div",4,0)(8,"div",5)(9,"dl",6)(10,"div",7)(11,"dt",8),t.EFF(12),t.k0s(),t.j41(13,"dd",9),t.EFF(14," Total Number of Orders"),t.k0s()(),t.j41(15,"div",7)(16,"dt",8),t.EFF(17),t.nI1(18,"currency"),t.k0s(),t.j41(19,"dd",10),t.EFF(20,"Total Amount"),t.k0s()(),t.j41(21,"div",7)(22,"dt",8),t.EFF(23),t.nI1(24,"currency"),t.k0s(),t.j41(25,"dd",10),t.EFF(26," Shopbot Commission"),t.k0s()(),t.j41(27,"div",7)(28,"dt",11),t.EFF(29),t.nI1(30,"currency"),t.k0s(),t.j41(31,"dd",10),t.EFF(32," Vendor Amount "),t.k0s()(),t.j41(33,"div",7)(34,"dt",11),t.EFF(35),t.nI1(36,"currency"),t.k0s(),t.j41(37,"dd",10),t.EFF(38," Wallet Balance "),t.k0s()()()(),t.j41(39,"table",12),t.qex(40,13),t.DNE(41,v,2,0,"th",14)(42,I,2,1,"td",15)(43,S,2,0,"td",16),t.bVm(),t.qex(44,17),t.DNE(45,y,2,0,"th",14)(46,x,3,4,"td",15)(47,A,1,0,"td",18),t.bVm(),t.qex(48,19),t.DNE(49,U,2,0,"th",14)(50,B,3,4,"td",15)(51,j,3,4,"td",16),t.bVm(),t.qex(52,20),t.DNE(53,L,2,0,"th",14)(54,$,3,4,"td",15)(55,k,3,4,"td",16),t.bVm(),t.qex(56,21),t.DNE(57,W,2,0,"th",14)(58,K,3,4,"td",15)(59,w,3,4,"td",16),t.bVm(),t.DNE(60,V,1,0,"tr",22)(61,G,1,0,"tr",23)(62,X,1,0,"tr",24),t.k0s()()()}2&o&&(t.R7$(12),t.SpI("",a.dataSource.data.length," "),t.R7$(5),t.SpI(" ",t.i5U(18,10,a.getTotalCost,a.store.currency)," "),t.R7$(6),t.SpI("",t.i5U(24,13,a.getShopbotTotal,a.store.currency)," "),t.R7$(6),t.SpI("",t.i5U(30,16,a.getVendorCost,a.store.currency)," "),t.R7$(6),t.SpI("",t.i5U(36,19,a.store.walletBalance,a.store.currency)," "),t.R7$(4),t.Y8G("dataSource",a.dataSource),t.R7$(21),t.Y8G("matHeaderRowDef",a.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",a.displayedColumns),t.R7$(),t.Y8G("matFooterRowDef",a.displayedColumns)("matFooterRowDefSticky",!0))},dependencies:[l.tP,l.Zl,l.tL,l.ji,l.cC,l.YV,l.iL,l.Zq,l.xW,l.KS,l.$R,l.Qo,l.YZ,l.NB,l.iF,m.MD,m.oe,m.vh,u.YN,u.X1,P.YF,D.DJ,D.sA,p.m_,p.An,h.Hl,h.$z],styles:["body[_ngcontent-%COMP%]{font-family:Covered By Your Grace,cursive;line-height:1.25}@media screen and (max-width: 960px){.mat-table[_ngcontent-%COMP%]{border:0;vertical-align:middle}.mat-table[_ngcontent-%COMP%]   caption[_ngcontent-%COMP%]{font-size:1em}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{border-bottom:5px solid #ddd;display:block}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{border-bottom:1px solid #ddd;display:block;font-size:1em;text-align:right;font-weight:700;height:30px;margin-bottom:4%}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]:before{content:attr(data-label);float:left;text-transform:uppercase;font-weight:400;font-size:.85em}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]:last-child{border-bottom:0}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]:first-child{margin-top:4%}}"]})}}return n})()}}]);