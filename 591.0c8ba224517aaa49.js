"use strict";(self.webpackChunkshopbot=self.webpackChunkshopbot||[]).push([[591],{4591:(nt,h,i)=>{i.r(h),i.d(h,{MessagesModule:()=>ot});var u=i(9808),l=i(6696),t=i(5e3);let M=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-messages"]],decls:1,vars:0,template:function(o,s){1&o&&t._UZ(0,"router-outlet")},dependencies:[l.lC],encapsulation:2}),e})();var T=i(449),_=i(9062),c=i(4999),x=i(454),Z=i(4382),r=i(4779),y=i(2349),v=i(7423),A=i(5245),L=i(7446),p=i(2181),f=i(7093);function S(e,n){if(1&e){const o=t.EpF();t.TgZ(0,"span",1)(1,"button",22),t._uU(2),t.qZA(),t.TgZ(3,"button",23)(4,"mat-icon",21),t._uU(5,"campaign"),t.qZA(),t._uU(6," Message Customers"),t.qZA(),t.TgZ(7,"button",24),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.deleteSelected())}),t.TgZ(8,"mat-icon",21),t._uU(9,"delete"),t.qZA(),t._uU(10," Delete Selected Customers"),t.qZA()()}if(2&e){const o=t.oxw();t.xp6(2),t.hij("",o.selection.selected.length," Selected")}}function b(e,n){if(1&e){const o=t.EpF();t.TgZ(0,"th",25)(1,"mat-checkbox",26),t.NdJ("change",function(a){t.CHM(o);const m=t.oxw();return t.KtG(a?m.toggleAllRows():null)}),t.qZA()()}if(2&e){const o=t.oxw();t.xp6(1),t.Q6J("checked",o.selection.hasValue()&&o.isAllSelected())("indeterminate",o.selection.hasValue()&&!o.isAllSelected())("aria-label",o.checkboxLabel())}}function N(e,n){if(1&e){const o=t.EpF();t.TgZ(0,"td",27)(1,"mat-checkbox",28),t.NdJ("click",function(a){return a.stopPropagation()})("change",function(a){const d=t.CHM(o).$implicit,g=t.oxw();return t.KtG(a?g.selection.toggle(d):null)}),t.qZA()()}if(2&e){const o=n.$implicit,s=t.oxw();t.xp6(1),t.Q6J("checked",s.selection.isSelected(o))("aria-label",s.checkboxLabel(o))}}function D(e,n){1&e&&(t.TgZ(0,"th",25),t._uU(1,"Recipients"),t.qZA())}function w(e,n){if(1&e&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.Oqu(o.recipients.length)}}function U(e,n){1&e&&(t.TgZ(0,"th",25),t._uU(1,"Phone Number"),t.qZA())}function R(e,n){if(1&e&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.Oqu(o.type)}}function Y(e,n){1&e&&(t.TgZ(0,"th",25),t._uU(1,"Email"),t.qZA())}function k(e,n){if(1&e&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.Oqu(o.email)}}function Q(e,n){1&e&&(t.TgZ(0,"th",25),t._uU(1,"Notification Type"),t.qZA())}function q(e,n){if(1&e&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.Oqu(o.type)}}function B(e,n){1&e&&(t.TgZ(0,"th",25),t._uU(1,"Title"),t.qZA())}function F(e,n){if(1&e&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.Oqu(o.title)}}function J(e,n){1&e&&(t.TgZ(0,"th",25),t._uU(1,"Body"),t.qZA())}function O(e,n){if(1&e&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.Oqu(o.body)}}function G(e,n){1&e&&(t.TgZ(0,"th",25),t._uU(1,"Registered at"),t.qZA())}function I(e,n){if(1&e&&(t.TgZ(0,"td",27),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,o.createdAt,"short"))}}function $(e,n){1&e&&(t.TgZ(0,"th",25),t._uU(1,"Actions"),t.qZA())}function z(e,n){if(1&e){const o=t.EpF();t.TgZ(0,"td",27)(1,"button",29)(2,"mat-icon"),t._uU(3,"more_vert"),t.qZA()(),t.TgZ(4,"mat-menu",null,30)(6,"button",31),t.NdJ("click",function(){const a=t.CHM(o),m=a.$implicit,d=a.index,g=t.oxw();return t.KtG(g.deleteNotification(m._id,d))}),t.TgZ(7,"mat-icon",32),t._uU(8,"delete"),t.qZA(),t.TgZ(9,"span"),t._uU(10,"Delete"),t.qZA()()()()}if(2&e){const o=t.MAs(5);t.xp6(1),t.Q6J("matMenuTriggerFor",o)}}function H(e,n){1&e&&t._UZ(0,"tr",33)}function E(e,n){1&e&&t._UZ(0,"tr",34)}const X=function(){return[15,30,60]};let j=(()=>{class e{constructor(o,s,a){this.route=o,this.notificationService=s,this._matDialog=a,this.displayedColumns=["select","recipients","type","title","body","createdAt","actions"],this.dataSource=new c.by([]),this.selection=new T.Ov(!0,[])}ngAfterViewInit(){this.dataSource.paginator=this.paginator}ngOnInit(){this.dataSource=new c.by(this.route.snapshot.data.notifications)}isAllSelected(){return this.selection.selected.length===this.dataSource.data.length}toggleAllRows(){this.isAllSelected()?this.selection.clear():this.selection.select(...this.dataSource.data)}deleteSelected(){this.confirmDialogRef=this._matDialog.open(x.X,{disableClose:!1}),this.confirmDialogRef.componentInstance.title="Delete notifications?",this.confirmDialogRef.componentInstance.confirmMessage="Are you sure you want to delete these notifications?",this.confirmDialogRef.componentInstance.confirmButton="Delete",this.confirmDialogRef.afterClosed().subscribe(o=>{o&&this.selection.selected.forEach((s,a)=>{this.dataSource.data.splice(a,1),this.dataSource=new c.by(this.dataSource.data),this.dataSource._updateChangeSubscription(),this.dataSource.paginator=this.paginator,this.notificationService.deleteNotification(s._id).subscribe()})})}checkboxLabel(o){return o?`${this.selection.isSelected(o)?"deselect":"select"} row ${o.position+1}`:(this.isAllSelected()?"deselect":"select")+" all"}deleteNotification(o,s){this.confirmDialogRef=this._matDialog.open(x.X,{disableClose:!1}),this.confirmDialogRef.componentInstance.title="Delete Customer?",this.confirmDialogRef.componentInstance.confirmMessage="Are you sure you want to delete this customer?",this.confirmDialogRef.componentInstance.confirmButton="Delete",this.confirmDialogRef.afterClosed().subscribe(a=>{a&&(this.dataSource.data.splice(s,1),this.dataSource=new c.by(this.dataSource.data),this.dataSource._updateChangeSubscription(),this.dataSource.paginator=this.paginator,this.notificationService.deleteNotification(o).subscribe())})}openMessaging(){this._matDialog.open(Z.D,{data:{customers:this.selection.selected,isBulkMsg:!0,allCustomers:!0},width:"500px"})}message(o){}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(l.gz),t.Y36(r.T),t.Y36(y.uw))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-list-messages"]],viewQuery:function(o,s){if(1&o&&t.Gf(_.NW,5),2&o){let a;t.iGM(a=t.CRH())&&(s.paginator=a.first)}},decls:44,vars:6,consts:[["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","start center",1,"card","bg-white","w-full","mat-elevation-z2","px-2","py-2"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","10px",1,"text-lg","font-thin"],["class","text-lg font-thin","fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","10px",4,"ngIf"],[1,"mat-elevation-z8"],["mat-table","",1,"w-full",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","recipients"],["matColumnDef","phoneNumber"],["matColumnDef","email"],["matColumnDef","type"],["matColumnDef","title"],["matColumnDef","body"],["matColumnDef","createdAt"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page of periodic elements",3,"pageSizeOptions"],["fxLayout","row","fxLayoutAlign","end center",1,"m-5"],["mat-fab","","color","primary",1,"m-10",3,"click"],[1,"mat-18"],["mat-button",""],["mat-stroked-button","","color","primary"],["mat-stroked-button","","color","warn",3,"click"],["mat-header-cell",""],[3,"checked","indeterminate","aria-label","change"],["mat-cell",""],[3,"checked","aria-label","click","change"],["mat-icon-button","","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],[1,"material-icons-outlined"],["mat-header-row",""],["mat-row",""]],template:function(o,s){1&o&&(t.TgZ(0,"div")(1,"div",0)(2,"span",1)(3,"span"),t._uU(4,"Messages and Notifications"),t.qZA()(),t.YNc(5,S,11,1,"span",2),t.qZA(),t.TgZ(6,"div",3)(7,"table",4),t.ynx(8,5),t.YNc(9,b,2,3,"th",6),t.YNc(10,N,2,2,"td",7),t.BQk(),t.ynx(11,8),t.YNc(12,D,2,0,"th",6),t.YNc(13,w,2,1,"td",7),t.BQk(),t.ynx(14,9),t.YNc(15,U,2,0,"th",6),t.YNc(16,R,2,1,"td",7),t.BQk(),t.ynx(17,10),t.YNc(18,Y,2,0,"th",6),t.YNc(19,k,2,1,"td",7),t.BQk(),t.ynx(20,11),t.YNc(21,Q,2,0,"th",6),t.YNc(22,q,2,1,"td",7),t.BQk(),t.ynx(23,12),t.YNc(24,B,2,0,"th",6),t._UZ(25,"th"),t.YNc(26,F,2,1,"td",7),t.BQk(),t.ynx(27,13),t.YNc(28,J,2,0,"th",6),t._UZ(29,"th"),t.YNc(30,O,2,1,"td",7),t.BQk(),t.ynx(31,14),t.YNc(32,G,2,0,"th",6),t.YNc(33,I,3,4,"td",7),t.BQk(),t.ynx(34,15),t.YNc(35,$,2,0,"th",6),t.YNc(36,z,11,1,"td",7),t.BQk(),t.YNc(37,H,1,0,"tr",16),t.YNc(38,E,1,0,"tr",17),t.qZA(),t._UZ(39,"mat-paginator",18),t.qZA(),t.TgZ(40,"div",19)(41,"button",20),t.NdJ("click",function(){return s.openMessaging()}),t.TgZ(42,"mat-icon",21),t._uU(43,"add"),t.qZA()()()()),2&o&&(t.xp6(5),t.Q6J("ngIf",s.selection.selected.length),t.xp6(2),t.Q6J("dataSource",s.dataSource),t.xp6(30),t.Q6J("matHeaderRowDef",s.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",s.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(5,X)))},dependencies:[u.O5,v.lW,A.Hw,_.NW,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,L.oG,p.VK,p.OP,p.p6,f.xw,f.SQ,f.Wh,u.uU]}),e})(),C=(()=>{class e{constructor(o){this.notificationService=o}resolve(){return this.notificationService.getNotifications()}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(r.T))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),K=(()=>{class e{constructor(o){this.notificationService=o}resolve(o){const s=o.paramMap.get("id");return this.notificationService.getNotification(s)}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(r.T))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const V=[{path:"",component:M,children:[{path:"list",component:j,resolve:{notifications:C}}]}];let W=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[l.Bz.forChild(V),l.Bz]}),e})();var P=i(2155),tt=i(3075),et=i(5221);let ot=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[r.T,C,K],imports:[u.ez,W,et.q,P.o9,tt.UX]}),e})()}}]);