"use strict";(self.webpackChunkshopbot=self.webpackChunkshopbot||[]).push([[3563],{3563:(W,v,s)=>{s.r(v),s.d(v,{FinanceModule:()=>Q});var c=s(177),f=s(8498),t=s(3953);let x=(()=>{class n{constructor(){}ngOnInit(){}static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-finance"]],decls:1,vars:0,template:function(r,o){1&r&&t.nrm(0,"router-outlet")},dependencies:[f.n3]})}return n})();var m=s(7586),a=s(9417),C=s(8141),I=s(3294),R=s(9172),k=s(5558),g=s(2643),$=s(7235),y=s(1626),T=s(5312);let F=(()=>{class n{constructor(e){this._httpClient=e,this.hostServer=T.c.hostServer}getFinances(e){let r=new y.Nl({fromObject:e});return this._httpClient.get(`${this.hostServer}/transactions/financial/reports?${r.toString()}`)}static#t=this.\u0275fac=function(r){return new(r||n)(t.KVO(y.Qq))};static#e=this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac})}return n})();var S=s(5351),G=s(6600),L=s(8834),u=s(3719),D=s(2798),d=s(5084),h=s(2920),O=s(6038);const M=["pdfTable"];function U(n,i){if(1&n&&(t.j41(0,"mat-option",27),t.EFF(1),t.k0s()),2&n){const e=i.$implicit;t.Y8G("value",e.country),t.R7$(),t.JRh(e.country)}}function b(n,i){1&n&&(t.j41(0,"mat-error"),t.EFF(1,"Invalid start date"),t.k0s())}function N(n,i){1&n&&(t.j41(0,"mat-error"),t.EFF(1,"Invalid end date"),t.k0s())}function J(n,i){if(1&n&&(t.j41(0,"tr",28)(1,"td",29)(2,"div",24),t.EFF(3),t.k0s()(),t.j41(4,"td",30),t.EFF(5),t.nI1(6,"date"),t.k0s(),t.j41(7,"th",31)(8,"div",32)(9,"div",33),t.EFF(10),t.k0s(),t.j41(11,"div",34),t.EFF(12),t.k0s()()(),t.j41(13,"td",30),t.EFF(14),t.k0s(),t.j41(15,"td",30),t.EFF(16),t.nI1(17,"currency"),t.k0s(),t.j41(18,"td",30),t.EFF(19),t.nI1(20,"currency"),t.k0s(),t.j41(21,"td",30),t.EFF(22),t.k0s(),t.j41(23,"td",30),t.EFF(24),t.nI1(25,"currency"),t.k0s()()),2&n){const e=i.$implicit,r=i.index;t.R7$(3),t.SpI(" ",r+1," "),t.R7$(2),t.SpI(" ",t.i5U(6,10,e.createdAt,"dd-MM-YYYY MM:HH:SS")," "),t.R7$(5),t.JRh(e.user.name),t.R7$(2),t.SpI("Order from ",e.store.name,""),t.R7$(2),t.SpI(" #",e.reference," "),t.R7$(2),t.SpI(" ",t.i5U(17,13,e.serviceFee,e.store.currency)," "),t.R7$(3),t.SpI(" ",t.i5U(20,16,e.shippingFee,e.store.currency)," "),t.R7$(3),t.Lme(" ",e.vendorCommissionAmount,"(%",e.vendorCommission,") "),t.R7$(2),t.SpI(" ",t.i5U(25,19,e.total,e.store.currency)," ")}}function Y(n,i){if(1&n){const e=t.RV6();t.j41(0,"div",3,0)(2,"div",4)(3,"div",5)(4,"p"),t.EFF(5,"Export"),t.k0s(),t.j41(6,"button",6),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.exportPDF())}),t.EFF(7,"PDF"),t.k0s()(),t.j41(8,"div",7)(9,"mat-form-field")(10,"mat-label"),t.EFF(11,"Select a country"),t.k0s(),t.j41(12,"mat-select",8),t.bIt("selectionChange",function(o){t.eBV(e);const l=t.XpG();return t.Njj(l.changeCurrency(o))}),t.DNE(13,U,2,2,"mat-option",9),t.k0s()(),t.j41(14,"mat-form-field",10)(15,"mat-label"),t.EFF(16,"Enter a date range"),t.k0s(),t.j41(17,"mat-date-range-input",11),t.nrm(18,"input",12)(19,"input",13),t.k0s(),t.nrm(20,"mat-datepicker-toggle",14)(21,"mat-date-range-picker",null,1),t.DNE(23,b,2,0,"mat-error",15)(24,N,2,0,"mat-error",15),t.k0s()()(),t.j41(25,"div",16)(26,"dl",17)(27,"div",18)(28,"dt",19),t.EFF(29),t.k0s(),t.j41(30,"dd",20),t.EFF(31,"Total Orders"),t.k0s()(),t.j41(32,"div",18)(33,"dt",19),t.EFF(34),t.nI1(35,"currency"),t.k0s(),t.j41(36,"dd",20),t.EFF(37,"Total Customer Delivery Fee"),t.k0s()(),t.j41(38,"div",18)(39,"dt",19),t.EFF(40),t.nI1(41,"currency"),t.k0s(),t.j41(42,"dd",20),t.EFF(43,"Total Customer Commissions"),t.k0s()(),t.j41(44,"div",18)(45,"dt",19),t.EFF(46),t.nI1(47,"currency"),t.k0s(),t.j41(48,"dd",20),t.EFF(49,"Total Vendor Commissions"),t.k0s()(),t.j41(50,"div",18)(51,"dt",19),t.EFF(52),t.nI1(53,"currency"),t.k0s(),t.j41(54,"dd",20),t.EFF(55,"Total Sales"),t.k0s()(),t.j41(56,"div",18)(57,"dt",19),t.EFF(58),t.nI1(59,"currency"),t.k0s(),t.j41(60,"dd",20),t.EFF(61,"Total Expenses"),t.k0s()(),t.j41(62,"div",18)(63,"dt",19),t.EFF(64),t.nI1(65,"currency"),t.k0s(),t.j41(66,"dd",20),t.EFF(67,"Gross Profits"),t.k0s()(),t.j41(68,"div",18)(69,"dt",19),t.EFF(70),t.nI1(71,"currency"),t.k0s(),t.j41(72,"dd",20),t.EFF(73,"Net income"),t.k0s()()()(),t.j41(74,"table",21)(75,"thead",22)(76,"tr")(77,"th",23)(78,"div",24),t.EFF(79," S/N "),t.k0s()(),t.j41(80,"th",23),t.EFF(81," Created "),t.k0s(),t.j41(82,"th",25),t.EFF(83," Name "),t.k0s(),t.j41(84,"th",25),t.EFF(85," Order Number "),t.k0s(),t.j41(86,"th",25),t.EFF(87," Service Fee "),t.k0s(),t.j41(88,"th",25),t.EFF(89," Shipping Fee "),t.k0s(),t.j41(90,"th",25),t.EFF(91," Vendor Commission "),t.k0s(),t.j41(92,"th",25),t.EFF(93," Total "),t.k0s()()(),t.j41(94,"tbody"),t.DNE(95,J,26,22,"tr",26),t.k0s()()()}if(2&n){const e=i.ngIf,r=t.sdS(22),o=t.XpG();t.R7$(8),t.Y8G("formGroup",o.range),t.R7$(5),t.Y8G("ngForOf",o.deliveries),t.R7$(4),t.Y8G("formGroup",o.range)("rangePicker",r),t.R7$(3),t.Y8G("for",r),t.R7$(3),t.Y8G("ngIf",o.range.controls.start.hasError("matStartDateInvalid")),t.R7$(),t.Y8G("ngIf",o.range.controls.end.hasError("matEndDateInvalid")),t.R7$(5),t.JRh(e.orders.length),t.R7$(5),t.JRh(t.i5U(35,16,e.deliveryFee,o.defaultCurrency)),t.R7$(6),t.JRh(t.i5U(41,19,e.customersServiceFee,o.defaultCurrency)),t.R7$(6),t.JRh(t.i5U(47,22,e.totalVendorCommissionAmount,o.defaultCurrency)),t.R7$(6),t.JRh(t.i5U(53,25,e.ordersTotal,o.defaultCurrency)),t.R7$(6),t.JRh(t.i5U(59,28,e.fundRequestsTotal,o.defaultCurrency)),t.R7$(6),t.JRh(t.i5U(65,31,e.totalProfits,o.defaultCurrency)),t.R7$(6),t.SpI("",t.i5U(71,34,e.totalProfits-e.fundRequestsTotal,o.defaultCurrency)," "),t.R7$(25),t.Y8G("ngForOf",e.orders)}}const j=m().startOf("month").toDate(),E=m().endOf("month").toDate(),P=s(5680);g.vfs=$.b.vfs;let V=(()=>{class n{constructor(e,r,o,l){this.route=e,this.financesService=r,this._matDialog=o,this.router=l,this.range=new a.gE({country:new a.MJ("Nigeria"),start:new a.MJ(j),end:new a.MJ(E)}),this.defaultCurrency="\u20a6",this.isLoading=!1,this.deliveries=[]}ngAfterViewInit(){}changeCurrency(e){const r=this.deliveries.find(o=>o.country==e.value);this.defaultCurrency=r?.currency}ngOnInit(){this.deliveries=this.route.snapshot.data.deliveries,this.getFinances()}openModal(e){this.router.navigate(["dashboard","reports","payouts",e,"details"])}getFinances(){this.finances$=this.range.valueChanges.pipe((0,C.M)(()=>this.isLoading=!0),(0,I.F)(),(0,R.Z)({start:j,end:E,country:"Nigeria"}),(0,k.n)(e=>this.financesService.getFinances(e)))}exportPDF(){var r=P(this.pdfTable.nativeElement.innerHTML);g.createPdf({content:r}).download()}static#t=this.\u0275fac=function(r){return new(r||n)(t.rXU(f.nX),t.rXU(F),t.rXU(S.bZ),t.rXU(f.Ix))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-finance-list"]],viewQuery:function(r,o){if(1&r&&t.GBs(M,5),2&r){let l;t.mGM(l=t.lsd())&&(o.pdfTable=l.first)}},decls:2,vars:3,consts:[["pdfTable",""],["picker",""],["class","relative overflow-x-auto shadow-md sm:rounded-lg","id","pdfTable",4,"ngIf"],["id","pdfTable",1,"relative","overflow-x-auto","shadow-md","sm:rounded-lg"],["fxLayout","row","fxLayoutAlign","space-between start","fxLayout.lt-md","column","fxLayoutAlign.lt-md","start stretch",1,"p-3","bg-white"],["ngClass.lt-md","mb-5 w-full"],["mat-raised-button","",3,"click"],["fxLayout","row","fxLayout.lt-md","column","fxLayoutGap","20px","fxLayoutAlign.lt-md","space-around stretch","fxLayoutAlign","space-between start",3,"formGroup"],["formControlName","country",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill"],[3,"formGroup","rangePicker"],["matStartDate","","formControlName","start","placeholder","Start date"],["matEndDate","","formControlName","end","placeholder","End date"],["matSuffix","",3,"for"],[4,"ngIf"],["id","stats",1,"p-4","bg-white","rounded-lg","md:p-8"],[1,"grid","max-w-screen-xl","grid-cols-1","gap-8","p-4","mx-auto","text-gray-900","sm:grid-cols-1","xl:grid-cols-3","sm:p-8"],[1,"flex","flex-col","items-center","justify-center"],[1,"mb-2","text-3xl","font-extrabold"],[1,"text-gray-500"],[1,"w-full","text-sm","text-left"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50"],["scope","col",1,"p-4"],[1,"flex","items-center"],["scope","col",1,"px-6","py-3"],["class","bg-white border-b ",4,"ngFor","ngForOf"],[3,"value"],[1,"bg-white","border-b"],[1,"w-4","p-4"],[1,"px-6","py-4"],["scope","row",1,"flex","items-center","px-6","py-4","font-medium","text-gray-900","whitespace-nowrap"],[1,"pl-3"],[1,"text-base","font-semibold"],[1,"font-normal","text-gray-500"]],template:function(r,o){1&r&&(t.DNE(0,Y,96,37,"div",2),t.nI1(1,"async")),2&r&&t.Y8G("ngIf",t.bMT(1,1,o.finances$))},dependencies:[c.Sq,c.bT,G.wT,L.$z,u.rl,u.nJ,u.TL,u.yw,D.VO,d.bU,d.el,d.xR,d.IG,d.SG,h.DJ,h.BO,h.sA,O.PW,a.me,a.BC,a.cb,a.j4,a.JD,c.Jj,c.oe,c.vh]})}return n})();var p=s(4e3);const X=[{path:"",component:x,children:[{path:"list",component:V,resolve:{deliveries:p.K}}]}];let w=(()=>{class n{static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275mod=t.$C({type:n});static#n=this.\u0275inj=t.G2t({imports:[f.iI.forChild(X),f.iI]})}return n})();var A=s(6924),B=s(3457),H=s(3887);let K=(()=>{class n{constructor(e){this.financesService=e}resolve(){const e=m().startOf("month").toDate(),r=m().endOf("month").toDate();return this.financesService.getFinances({start:e,end:r})}static#t=this.\u0275fac=function(r){return new(r||n)(t.KVO(F))};static#e=this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var z=s(4919);let Q=(()=>{class n{static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275mod=t.$C({type:n});static#n=this.\u0275inj=t.G2t({providers:[F,K,p.K,p.X,z.s],imports:[c.MD,w,B.G,A.YF,a.X1,a.YN,H.G,d.X6]})}return n})()}}]);