"use strict";(self.webpackChunkshopbot=self.webpackChunkshopbot||[]).push([[136],{9136:(Ht,A,a)=>{a.r(A),a.d(A,{CustomersModule:()=>$t});var p=a(6814),_=a(1896),t=a(5879),g=a(1803);let T=(()=>{class o{constructor(e){this.userService=e}resolve(){return this.userService.getUsers()}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(g.f))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),v=(()=>{class o{constructor(e){this.userService=e}resolve(e){const n=e.paramMap.get("id");return this.userService.getUser(n)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(g.f))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),N=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-customers"]],decls:1,vars:0,template:function(e,n){1&e&&t._UZ(0,"router-outlet")},dependencies:[_.lC]}),o})();var c=a(5313),x=a(3365),y=a(8337),h=a(6567),D=a(437),u=a(7700),C=a(2296),U=a(617),L=a(3566),q=a(5986),Z=a(7988),m=a(3814);function k(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"span",1)(1,"button",18),t._uU(2),t.qZA(),t.TgZ(3,"button",19),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.sendMessagesToSelectedCustomers())}),t.TgZ(4,"mat-icon",20),t._uU(5,"campaign"),t.qZA(),t._uU(6," Message Customers"),t.qZA(),t.TgZ(7,"button",21),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.deleteSelected())}),t.TgZ(8,"mat-icon",20),t._uU(9,"delete"),t.qZA(),t._uU(10," Delete Selected Customers"),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(2),t.hij("",e.selection.selected.length," Selected")}}function R(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"th",22)(1,"mat-checkbox",23),t.NdJ("change",function(s){t.CHM(e);const l=t.oxw();return t.KtG(s?l.toggleAllRows():null)}),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("checked",e.selection.hasValue()&&e.isAllSelected())("indeterminate",e.selection.hasValue()&&!e.isAllSelected())("aria-label",e.checkboxLabel())}}function Y(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",24)(1,"mat-checkbox",25),t.NdJ("click",function(s){return s.stopPropagation()})("change",function(s){const d=t.CHM(e).$implicit,f=t.oxw();return t.KtG(s?f.selection.toggle(d):null)}),t.qZA()()}if(2&o){const e=i.$implicit,n=t.oxw();t.xp6(1),t.Q6J("checked",n.selection.isSelected(e))("aria-label",n.checkboxLabel(e))}}function I(o,i){1&o&&(t.TgZ(0,"th",22),t._uU(1,"Name"),t.qZA())}function J(o,i){if(1&o&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.Oqu(e.name)}}function M(o,i){1&o&&(t.TgZ(0,"th",22),t._uU(1,"Phone Number"),t.qZA())}function O(o,i){if(1&o&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.Oqu(e.phoneNumber)}}function Q(o,i){1&o&&(t.TgZ(0,"th",22),t._uU(1,"Email"),t.qZA())}function F(o,i){if(1&o&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.Oqu(e.email)}}function E(o,i){1&o&&(t.TgZ(0,"th",22),t._uU(1,"Device"),t.qZA())}function G(o,i){if(1&o&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.Oqu((null==e||null==e.phoneCredentials[0]?null:e.phoneCredentials[0].deviceType)+" "+(null==e||null==e.phoneCredentials[0]?null:e.phoneCredentials[0].make)+" "+(null==e||null==e.phoneCredentials[0]?null:e.phoneCredentials[0].os))}}function B(o,i){1&o&&(t.TgZ(0,"th",22),t._uU(1,"Country"),t.qZA())}function $(o,i){if(1&o&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.Oqu(e.country)}}function H(o,i){1&o&&(t.TgZ(0,"th",22),t._uU(1,"Registered at"),t.qZA())}function z(o,i){if(1&o&&(t.TgZ(0,"td",24),t._uU(1),t.ALo(2,"date"),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e.createdAt,"short"))}}function K(o,i){1&o&&(t.TgZ(0,"th",22),t._uU(1,"Actions"),t.qZA())}const X=function(o){return["../",o,"details"]};function W(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",24)(1,"button",26)(2,"mat-icon"),t._uU(3,"more_vert"),t.qZA()(),t.TgZ(4,"mat-menu",null,27)(6,"button",28),t.NdJ("click",function(){const l=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.message(l))}),t.TgZ(7,"mat-icon",29),t._uU(8,"campaign"),t.qZA(),t.TgZ(9,"span"),t._uU(10,"Message Customer"),t.qZA()(),t.TgZ(11,"button",28),t.NdJ("click",function(){const s=t.CHM(e),l=s.$implicit,d=s.index,f=t.oxw();return t.KtG(f.deleteUser(l._id,d))}),t.TgZ(12,"mat-icon",29),t._uU(13,"delete"),t.qZA(),t.TgZ(14,"span"),t._uU(15,"Delete"),t.qZA()(),t.TgZ(16,"button",30)(17,"mat-icon",29),t._uU(18,"person"),t.qZA(),t.TgZ(19,"span"),t._uU(20,"Profile"),t.qZA()()()()}if(2&o){const e=i.$implicit,n=t.MAs(5);t.xp6(1),t.Q6J("matMenuTriggerFor",n),t.xp6(15),t.Q6J("routerLink",t.VKq(2,X,e._id))}}function V(o,i){1&o&&t._UZ(0,"tr",31)}function j(o,i){1&o&&t._UZ(0,"tr",32)}const P=function(){return[15,30,60]};let tt=(()=>{class o{constructor(e,n,s){this.route=e,this.userService=n,this._matDialog=s,this.displayedColumns=["select","Name","phoneNumber","email","device","country","createdAt","actions"],this.dataSource=new c.by([]),this.selection=new y.Ov(!0,[])}ngAfterViewInit(){this.dataSource.paginator=this.paginator}ngOnInit(){this.dataSource=new c.by(this.route.snapshot.data.customers)}isAllSelected(){return this.selection.selected.length===this.dataSource.data.length}toggleAllRows(){this.isAllSelected()?this.selection.clear():this.selection.select(...this.dataSource.data)}deleteSelected(){this.confirmDialogRef=this._matDialog.open(h.X,{disableClose:!1}),this.confirmDialogRef.componentInstance.title="Delete customers?",this.confirmDialogRef.componentInstance.confirmMessage="Are you sure you want to delete these customers?",this.confirmDialogRef.componentInstance.confirmButton="Delete",this.confirmDialogRef.afterClosed().subscribe(e=>{e&&this.selection.selected.forEach((n,s)=>{this.dataSource.data.splice(s,1),this.dataSource=new c.by(this.dataSource.data),this.dataSource._updateChangeSubscription(),this.dataSource.paginator=this.paginator,this.userService.deleteUser(n._id).subscribe()})})}checkboxLabel(e){return e?`${this.selection.isSelected(e)?"deselect":"select"} row ${e.position+1}`:(this.isAllSelected()?"deselect":"select")+" all"}deleteUser(e,n){this.confirmDialogRef=this._matDialog.open(h.X,{disableClose:!1}),this.confirmDialogRef.componentInstance.title="Delete Customer?",this.confirmDialogRef.componentInstance.confirmMessage="Are you sure you want to delete this customer?",this.confirmDialogRef.componentInstance.confirmButton="Delete",this.confirmDialogRef.afterClosed().subscribe(s=>{s&&(this.dataSource.data.splice(n,1),this.dataSource=new c.by(this.dataSource.data),this.dataSource._updateChangeSubscription(),this.dataSource.paginator=this.paginator,this.userService.deleteUser(e).subscribe())})}message(e){this._matDialog.open(D.D,{data:{customers:e,isBulkMsg:!1,allCustomers:!1},width:"500px"})}sendMessagesToSelectedCustomers(){this._matDialog.open(D.D,{data:{customers:this.selection.selected,isBulkMsg:!0,allCustomers:!1},width:"500px"})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(_.gz),t.Y36(g.f),t.Y36(u.uw))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-list-customers"]],viewQuery:function(e,n){if(1&e&&t.Gf(x.NW,5),2&e){let s;t.iGM(s=t.CRH())&&(n.paginator=s.first)}},decls:35,vars:6,consts:[["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","start center",1,"card","bg-white","w-full","mat-elevation-z2","px-2","py-2"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","10px",1,"text-lg","font-thin"],["class","text-lg font-thin","fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","10px",4,"ngIf"],[1,"mat-elevation-z8"],["mat-table","","matSort","","matTableResponsive","",1,"w-full",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Name"],["matColumnDef","phoneNumber"],["matColumnDef","email"],["matColumnDef","device"],["matColumnDef","country"],["matColumnDef","createdAt"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page of periodic elements",3,"pageSizeOptions"],["mat-button",""],["mat-stroked-button","","color","primary",3,"click"],[1,"mat-18"],["mat-stroked-button","","color","warn",3,"click"],["mat-header-cell",""],[3,"checked","indeterminate","aria-label","change"],["mat-cell",""],[3,"checked","aria-label","click","change"],["mat-icon-button","","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],[1,"material-icons-outlined"],["mat-menu-item","",3,"routerLink"],["mat-header-row",""],["mat-row",""]],template:function(e,n){1&e&&(t.TgZ(0,"div")(1,"div",0)(2,"span",1)(3,"span"),t._uU(4,"Customers"),t.qZA()(),t.YNc(5,k,11,1,"span",2),t.qZA(),t.TgZ(6,"div",3)(7,"table",4),t.ynx(8,5),t.YNc(9,R,2,3,"th",6),t.YNc(10,Y,2,2,"td",7),t.BQk(),t.ynx(11,8),t.YNc(12,I,2,0,"th",6),t.YNc(13,J,2,1,"td",7),t.BQk(),t.ynx(14,9),t.YNc(15,M,2,0,"th",6),t.YNc(16,O,2,1,"td",7),t.BQk(),t.ynx(17,10),t.YNc(18,Q,2,0,"th",6),t.YNc(19,F,2,1,"td",7),t.BQk(),t.ynx(20,11),t.YNc(21,E,2,0,"th",6),t.YNc(22,G,2,1,"td",7),t.BQk(),t.ynx(23,12),t.YNc(24,B,2,0,"th",6),t.YNc(25,$,2,1,"td",7),t.BQk(),t.ynx(26,13),t.YNc(27,H,2,0,"th",6),t.YNc(28,z,3,4,"td",7),t.BQk(),t.ynx(29,14),t.YNc(30,K,2,0,"th",6),t.YNc(31,W,21,4,"td",7),t.BQk(),t.YNc(32,V,1,0,"tr",15),t.YNc(33,j,1,0,"tr",16),t.qZA(),t._UZ(34,"mat-paginator",17),t.qZA()()),2&e&&(t.xp6(5),t.Q6J("ngIf",n.selection.selected.length),t.xp6(2),t.Q6J("dataSource",n.dataSource),t.xp6(25),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(5,P)))},dependencies:[p.O5,_.rH,C.lW,C.RK,U.Hw,x.NW,L.YE,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,q.oG,Z.VK,Z.OP,Z.p6,m.xw,m.SQ,m.Wh,p.uU],styles:["tr[_ngcontent-%COMP%]:hover{background:whitesmoke}"]}),o})();var et=a(7398),r=a(6223),ot=a(3680),b=a(9157),S=a(2032),nt=a(8525);function it(o,i){if(1&o&&(t.TgZ(0,"mat-option",13),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function st(o,i){if(1&o&&(t.TgZ(0,"mat-option",13),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function at(o,i){if(1&o&&(t.TgZ(0,"mat-option",13),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}const ct=function(){return["Male","Female"]},rt=function(){return["English","French"]},lt=function(){return["Nigeria","Mauritius"]};let ut=(()=>{class o{constructor(e,n,s,l){this.fb=e,this.userService=n,this.dialogRef=s,this.data=l,this.customerForm=this.fb.group({name:[this.data.name,r.kI.required],phoneNumber:[this.data.phoneNumber,r.kI.required],gender:[this.data.gender,r.kI.required],email:[this.data.email,[r.kI.required,r.kI.email]],language:[this.data.language],country:[this.data.country]})}ngOnInit(){console.log(this.data)}submit(){this.customerForm.valid&&this.userService.updateUser(this.data._id,this.customerForm.getRawValue()).subscribe(e=>{this.dialogRef.close(this.customerForm.getRawValue())})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(r.qu),t.Y36(g.f),t.Y36(u.so),t.Y36(u.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-edit-customers-info"]],decls:37,vars:8,consts:[["matDialogTitle",""],[3,"formGroup"],["fxLayout","column","fxLayoutAlign","space-evenly stretch"],["appearance","outline",1,"full-width"],["matInput","","placeholder","Full Name","formControlName","name"],["matInput","","placeholder","Phone Number","formControlName","phoneNumber"],["matInput","","placeholder","Email","formControlName","email"],["formControlName","gender"],[3,"value",4,"ngFor","ngForOf"],["formControlName","language"],["formControlName","country"],["mat-button","","matDialogClose",""],["mat-raised-button","","color","primary",3,"disabled","click"],[3,"value"]],template:function(e,n){1&e&&(t.TgZ(0,"h1",0),t._uU(1,"Edit customer"),t.qZA(),t.TgZ(2,"mat-dialog-content")(3,"form",1)(4,"div",2)(5,"mat-form-field",3)(6,"mat-label"),t._uU(7,"Full Name"),t.qZA(),t._UZ(8,"input",4),t.qZA(),t.TgZ(9,"mat-form-field",3)(10,"mat-label"),t._uU(11,"Phone Number"),t.qZA(),t._UZ(12,"input",5),t.qZA(),t.TgZ(13,"mat-form-field",3)(14,"mat-label"),t._uU(15,"Email"),t.qZA(),t._UZ(16,"input",6),t.qZA(),t.TgZ(17,"mat-form-field",3)(18,"mat-label"),t._uU(19,"Gender"),t.qZA(),t.TgZ(20,"mat-select",7),t.YNc(21,it,2,2,"mat-option",8),t.qZA()(),t.TgZ(22,"mat-form-field",3)(23,"mat-label"),t._uU(24,"Language"),t.qZA(),t.TgZ(25,"mat-select",9),t.YNc(26,st,2,2,"mat-option",8),t.qZA()(),t.TgZ(27,"mat-form-field",3)(28,"mat-label"),t._uU(29,"Country"),t.qZA(),t.TgZ(30,"mat-select",10),t.YNc(31,at,2,2,"mat-option",8),t.qZA()()()()(),t.TgZ(32,"mat-dialog-actions")(33,"button",11),t._uU(34,"CANCEL"),t.qZA(),t.TgZ(35,"button",12),t.NdJ("click",function(){return n.submit()}),t._uU(36,"Save"),t.qZA()()),2&e&&(t.xp6(3),t.Q6J("formGroup",n.customerForm),t.xp6(18),t.Q6J("ngForOf",t.DdM(5,ct)),t.xp6(5),t.Q6J("ngForOf",t.DdM(6,rt)),t.xp6(5),t.Q6J("ngForOf",t.DdM(7,lt)),t.xp6(4),t.Q6J("disabled",n.customerForm.invalid))},dependencies:[p.sg,ot.ey,C.lW,b.KE,b.hX,S.Nt,nt.gD,u.ZT,u.uh,u.xY,u.H8,m.xw,m.Wh,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u]}),o})(),mt=(()=>{class o{constructor(e,n,s,l){this.fb=e,this.userService=n,this.dialogRef=s,this.data=l,this.customerForm=this.fb.group({notes:[this.data.notes]})}ngOnInit(){}submit(){this.customerForm.valid&&this.userService.updateUser(this.data._id,this.customerForm.getRawValue()).subscribe(e=>{this.dialogRef.close(this.customerForm.getRawValue())})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(r.qu),t.Y36(g.f),t.Y36(u.so),t.Y36(u.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-edit-customers-notes"]],decls:14,vars:2,consts:[["matDialogTitle",""],[3,"formGroup"],["fxLayout","column","fxLayoutAlign","space-evenly stretch"],["appearance","outline",1,"full-width"],["matInput","","placeholder","Add a note","formControlName","notes"],["mat-button","","matDialogClose",""],["mat-raised-button","","color","primary",3,"disabled","click"]],template:function(e,n){1&e&&(t.TgZ(0,"h1",0),t._uU(1,"Edit Notes"),t.qZA(),t.TgZ(2,"mat-dialog-content")(3,"form",1)(4,"div",2)(5,"mat-form-field",3)(6,"mat-label"),t._uU(7,"Add a note"),t.qZA(),t._UZ(8,"textarea",4),t.qZA()()()(),t.TgZ(9,"mat-dialog-actions")(10,"button",5),t._uU(11,"CANCEL"),t.qZA(),t.TgZ(12,"button",6),t.NdJ("click",function(){return n.submit()}),t._uU(13,"Save"),t.qZA()()),2&e&&(t.xp6(3),t.Q6J("formGroup",n.customerForm),t.xp6(9),t.Q6J("disabled",n.customerForm.invalid))},dependencies:[C.lW,b.KE,b.hX,S.Nt,u.ZT,u.uh,u.xY,u.H8,m.xw,m.Wh,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u]}),o})();var dt=a(2599);let pt=(()=>{class o{constructor(e,n,s,l){this.fb=e,this.userService=n,this.dialogRef=s,this.data=l,this.customerForm=this.fb.group({allowNotifications:[this.data.allowNotifications,r.kI.required],allowSalesNotifications:[this.data.allowSalesNotifications,r.kI.required]})}ngOnInit(){}submit(){this.customerForm.valid&&this.userService.updateUser(this.data._id,this.customerForm.getRawValue()).subscribe(e=>{this.dialogRef.close(this.customerForm.getRawValue())})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(r.qu),t.Y36(g.f),t.Y36(u.so),t.Y36(u.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-edit-customers-marketing-status"]],decls:14,vars:2,consts:[["matDialogTitle",""],[3,"formGroup"],["fxLayout","column","fxLayoutAlign","space-evenly stretch","fxLayoutGap","20px"],["formControlName","allowNotifications"],["formControlName","allowSalesNotifications"],["mat-button","","matDialogClose",""],["mat-raised-button","","color","primary",3,"disabled","click"]],template:function(e,n){1&e&&(t.TgZ(0,"h1",0),t._uU(1,"Edit Marketing Status"),t.qZA(),t.TgZ(2,"mat-dialog-content")(3,"form",1)(4,"div",2)(5,"mat-slide-toggle",3),t._uU(6,"Mobile Notification Subscribed"),t.qZA(),t.TgZ(7,"mat-slide-toggle",4),t._uU(8,"Sales Notification Subscribed"),t.qZA()()()(),t.TgZ(9,"mat-dialog-actions")(10,"button",5),t._uU(11,"CANCEL"),t.qZA(),t.TgZ(12,"button",6),t.NdJ("click",function(){return n.submit()}),t._uU(13,"Save"),t.qZA()()),2&e&&(t.xp6(3),t.Q6J("formGroup",n.customerForm),t.xp6(9),t.Q6J("disabled",n.customerForm.invalid))},dependencies:[C.lW,u.ZT,u.uh,u.xY,u.H8,dt.Rr,m.xw,m.SQ,m.Wh,r._Y,r.JJ,r.JL,r.sg,r.u]}),o})();var ft=a(7957),w=a(9038);function _t(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"span",29)(1,"button",8),t._uU(2),t.qZA(),t.TgZ(3,"button",44)(4,"mat-icon",4),t._uU(5,"campaign"),t.qZA(),t._uU(6," Message Customers"),t.qZA(),t.TgZ(7,"button",45),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2);return t.KtG(s.deleteSelected())}),t.TgZ(8,"mat-icon",4),t._uU(9,"delete"),t.qZA(),t._uU(10," Delete Selected Customers"),t.qZA()()}if(2&o){const e=t.oxw(2);t.xp6(2),t.hij("",e.selection.selected.length," Selected")}}function gt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"th",46)(1,"mat-checkbox",47),t.NdJ("change",function(s){t.CHM(e);const l=t.oxw(2);return t.KtG(s?l.toggleAllRows():null)}),t.qZA()()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("checked",e.selection.hasValue()&&e.isAllSelected())("indeterminate",e.selection.hasValue()&&!e.isAllSelected())("aria-label",e.checkboxLabel())}}function ht(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",48)(1,"mat-checkbox",49),t.NdJ("click",function(s){return s.stopPropagation()})("change",function(s){const d=t.CHM(e).$implicit,f=t.oxw(2);return t.KtG(s?f.selection.toggle(d):null)}),t.qZA()()}if(2&o){const e=i.$implicit,n=t.oxw(2);t.xp6(1),t.Q6J("checked",n.selection.isSelected(e))("aria-label",n.checkboxLabel(e))}}function Ct(o,i){1&o&&(t.TgZ(0,"th",46),t._uU(1,"Order Num"),t.qZA())}function Zt(o,i){if(1&o&&(t.TgZ(0,"td",48),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.Oqu(e.reference)}}function xt(o,i){1&o&&(t.TgZ(0,"th",46),t._uU(1,"Category"),t.qZA())}function bt(o,i){if(1&o&&(t.TgZ(0,"td",48),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.Oqu(e.category)}}function At(o,i){1&o&&(t.TgZ(0,"th",46),t._uU(1,"Store"),t.qZA())}function Tt(o,i){if(1&o&&(t.TgZ(0,"td",48),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.Oqu(e.store.name)}}function vt(o,i){1&o&&(t.TgZ(0,"th",46),t._uU(1,"Amount"),t.qZA())}function yt(o,i){if(1&o&&(t.TgZ(0,"td",48),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,null==e?null:e.total))}}function Dt(o,i){1&o&&(t.TgZ(0,"th",46),t._uU(1,"Ordered"),t.qZA())}function Ut(o,i){if(1&o&&(t.TgZ(0,"td",48),t._uU(1),t.ALo(2,"date"),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e.createdAt,"short"))}}function qt(o,i){1&o&&(t.TgZ(0,"th",46),t._uU(1,"Actions"),t.qZA())}const St=function(o){return["../",o,"details"]};function wt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",48)(1,"button",50)(2,"mat-icon"),t._uU(3,"more_vert"),t.qZA()(),t.TgZ(4,"mat-menu",null,51)(6,"button",52),t.NdJ("click",function(){const l=t.CHM(e).$implicit,d=t.oxw(2);return t.KtG(d.message(l))}),t.TgZ(7,"mat-icon",53),t._uU(8,"campaign"),t.qZA(),t.TgZ(9,"span"),t._uU(10,"Message Customer"),t.qZA()(),t.TgZ(11,"button",52),t.NdJ("click",function(){const s=t.CHM(e),l=s.$implicit,d=s.index,f=t.oxw(2);return t.KtG(f.deleteOrder(l._id,d))}),t.TgZ(12,"mat-icon",53),t._uU(13,"delete"),t.qZA(),t.TgZ(14,"span"),t._uU(15,"Delete"),t.qZA()(),t.TgZ(16,"button",54)(17,"mat-icon",53),t._uU(18,"receipt_long"),t.qZA(),t.TgZ(19,"span"),t._uU(20,"Open Order"),t.qZA()()()()}if(2&o){const e=i.$implicit,n=t.MAs(5);t.xp6(1),t.Q6J("matMenuTriggerFor",n),t.xp6(15),t.Q6J("routerLink",t.VKq(2,St,e._id))}}function Nt(o,i){1&o&&t._UZ(0,"tr",55)}function Lt(o,i){1&o&&t._UZ(0,"tr",56)}const kt=function(){return[5,10,15]};function Rt(o,i){if(1&o&&(t.TgZ(0,"div",27)(1,"div",28)(2,"span",29)(3,"span"),t._uU(4,"Orders"),t.qZA()(),t.YNc(5,_t,11,1,"span",30),t.qZA(),t.TgZ(6,"table",31),t.ynx(7,32),t.YNc(8,gt,2,3,"th",33),t.YNc(9,ht,2,2,"td",34),t.BQk(),t.ynx(10,35),t.YNc(11,Ct,2,0,"th",33),t.YNc(12,Zt,2,1,"td",34),t.BQk(),t.ynx(13,36),t.YNc(14,xt,2,0,"th",33),t.YNc(15,bt,2,1,"td",34),t.BQk(),t.ynx(16,37),t.YNc(17,At,2,0,"th",33),t.YNc(18,Tt,2,1,"td",34),t.BQk(),t.ynx(19,38),t.YNc(20,vt,2,0,"th",33),t.YNc(21,yt,3,3,"td",34),t.BQk(),t.ynx(22,39),t.YNc(23,Dt,2,0,"th",33),t.YNc(24,Ut,3,4,"td",34),t.BQk(),t.ynx(25,40),t.YNc(26,qt,2,0,"th",33),t.YNc(27,wt,21,4,"td",34),t.BQk(),t.YNc(28,Nt,1,0,"tr",41),t.YNc(29,Lt,1,0,"tr",42),t.qZA(),t._UZ(30,"mat-paginator",43),t.qZA()),2&o){const e=t.oxw();t.xp6(5),t.Q6J("ngIf",e.selection.selected.length),t.xp6(1),t.Q6J("dataSource",e.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(5,kt))}}function Yt(o,i){1&o&&(t.TgZ(0,"mat-icon",57),t._uU(1,"verified"),t.qZA())}function It(o,i){if(1&o&&(t.TgZ(0,"mat-list-item")(1,"mat-icon",24),t._uU(2,"place"),t.qZA(),t._uU(3),t.qZA()),2&o){const e=t.oxw();t.xp6(3),t.Oqu(e.customer.shipping.name)}}function Jt(o,i){if(1&o&&(t.TgZ(0,"mat-list-item")(1,"mat-icon",24),t._uU(2,"flag"),t.qZA(),t._uU(3),t.qZA()),2&o){const e=t.oxw();t.xp6(3),t.Oqu(e.customer.country)}}function Mt(o,i){if(1&o&&(t.TgZ(0,"mat-list-item")(1,"mat-icon",24),t._uU(2,"male"),t.qZA(),t._uU(3),t.qZA()),2&o){const e=t.oxw();t.xp6(3),t.Oqu(e.customer.gender)}}function Ot(o,i){if(1&o&&(t.TgZ(0,"mat-list-item")(1,"mat-icon",24),t._uU(2,"language"),t.qZA(),t._uU(3),t.qZA()),2&o){const e=t.oxw();t.xp6(3),t.Oqu(e.customer.language)}}const Qt=[{path:"",component:N,children:[{path:"list",component:tt,resolve:{customers:T}},{path:":id/details",component:(()=>{class o{constructor(e,n,s,l,d,f){this.route=e,this.userService=n,this.orderService=s,this.router=l,this.location=d,this._matDialog=f,this.displayedColumns=["select","reference","category","store","amount","createdAt","actions"],this.dataSource=new c.by([]),this.selection=new y.Ov(!0,[])}ngOnInit(){this.customer=this.route.snapshot.data.customer,this.getCustomerOrders(this.customer._id)}getCustomerOrders(e){this.orders$=this.orderService.getUserOrders(e).pipe((0,et.U)(n=>(this.dataSource=new c.by(n),this.dataSource.paginator=this.paginator,n)))}back(){this.location.back()}ngAfterViewInit(){}checkboxLabel(e){return e?`${this.selection.isSelected(e)?"deselect":"select"} row ${e.position+1}`:(this.isAllSelected()?"deselect":"select")+" all"}isAllSelected(){return this.selection.selected.length===this.dataSource.data.length}toggleAllRows(){this.isAllSelected()?this.selection.clear():this.selection.select(...this.dataSource.data)}deleteUser(e,n){this.confirmDialogRef=this._matDialog.open(h.X,{disableClose:!1}),this.confirmDialogRef.componentInstance.title="Delete Customer?",this.confirmDialogRef.componentInstance.confirmMessage="Are you sure you want to delete this customer?",this.confirmDialogRef.componentInstance.confirmButton="Delete",this.confirmDialogRef.afterClosed().subscribe(s=>{s&&(this.dataSource.data.splice(n,1),this.dataSource=new c.by(this.dataSource.data),this.dataSource._updateChangeSubscription(),this.dataSource.paginator=this.paginator,this.userService.deleteUser(e).subscribe())})}deleteOrder(e,n){this.confirmDialogRef=this._matDialog.open(h.X,{disableClose:!1}),this.confirmDialogRef.componentInstance.title="Delete Order?",this.confirmDialogRef.componentInstance.confirmMessage="Are you sure you want to delete this order?",this.confirmDialogRef.componentInstance.confirmButton="Delete",this.confirmDialogRef.afterClosed().subscribe(s=>{s&&(this.dataSource.data.splice(n,1),this.dataSource=new c.by(this.dataSource.data),this.dataSource._updateChangeSubscription(),this.dataSource.paginator=this.paginator,this.orderService.deleteOrder(e).subscribe())})}deleteSelected(){this.confirmDialogRef=this._matDialog.open(h.X,{disableClose:!1}),this.confirmDialogRef.componentInstance.title="Delete orders?",this.confirmDialogRef.componentInstance.confirmMessage="Are you sure you want to delete these orders?",this.confirmDialogRef.componentInstance.confirmButton="Delete",this.confirmDialogRef.afterClosed().subscribe(e=>{e&&this.selection.selected.forEach((n,s)=>{this.dataSource.data.splice(s,1),this.dataSource=new c.by(this.dataSource.data),this.dataSource._updateChangeSubscription(),this.dataSource.paginator=this.paginator,this.userService.deleteUser(n._id).subscribe()})})}openCustomerBasicInfo(){this._matDialog.open(ut,{data:this.customer,width:"400px"}).afterClosed().subscribe(n=>{n&&(this.customer={...this.customer,...n})})}openCustomerNote(){this._matDialog.open(mt,{data:this.customer,width:"400px"}).afterClosed().subscribe(n=>{n&&(this.customer={...this.customer,...n})})}openCustomerMarketingStatus(){this._matDialog.open(pt,{data:this.customer,width:"400px"}).afterClosed().subscribe(n=>{n&&(this.customer={...this.customer,...n})})}disableAccount(){this.confirmDialogRef=this._matDialog.open(h.X,{disableClose:!1}),this.confirmDialogRef.componentInstance.title=this.customer.deleteAccount?"Enable Account?":"Disable Account?",this.confirmDialogRef.componentInstance.confirmMessage=this.customer.deleteAccount?"Are you sure you want enable this account":"Are you sure you want to disable this account?",this.confirmDialogRef.componentInstance.confirmButton=this.customer.deleteAccount?"Enable Account":"Disable Account",this.confirmDialogRef.afterClosed().subscribe(e=>{e&&(this.customer={...this.customer,deleteAccount:!this.customer.deleteAccount},this.userService.updateUser(this.customer._id,{deleteAccount:this.customer.deleteAccount}).subscribe())})}deleteAccount(){this.confirmDialogRef=this._matDialog.open(h.X,{disableClose:!1}),this.confirmDialogRef.componentInstance.title="Delete customers?",this.confirmDialogRef.componentInstance.confirmMessage="Are you sure you want to delete these customers?",this.confirmDialogRef.componentInstance.confirmButton="Delete",this.confirmDialogRef.afterClosed().subscribe(e=>{e&&this.userService.deleteUser(this.customer._id).subscribe(()=>{this.location.back()})})}message(e){}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(_.gz),t.Y36(g.f),t.Y36(ft.N),t.Y36(_.F0),t.Y36(p.Ye),t.Y36(u.uw))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-customers-details"]],viewQuery:function(e,n){if(1&e&&t.Gf(x.NW,5),2&e){let s;t.iGM(s=t.CRH())&&(n.paginator=s.first)}},decls:91,vars:23,consts:[[1,"md:container","md:mx-auto"],["fxLayout","row","fxLayoutAlign","space-between start",1,"mb-10"],["fxLayout","row","fxLayoutAlign","start start","flexLayoutGap","10px"],["mat-icon-button","",3,"click"],[1,"mat-18"],["fxLayout","column","fxLayoutAlign","start start"],[2,"margin","0px"],["fxLayout","row","fxLayoutAlign","start start"],["mat-button",""],["mat-button","",3,"click"],["mat-button","",3,"color","click"],["fxLayout","row","fxLayoutAlign","space-between start","fxLayoutGap","20px"],["fxLayout","column","fxLayoutAlign","space-around start","fxFlex","60%"],["fxLayout","row","fxLayoutAlign","space-between center",1,"mat-elevation-z3","divide-x","divide-gray-300","rounded-md","p-5","w-full"],["fxLayout","column","fxLayoutAlign","space-evenly center ","fxFlex","30%",1,"text-center"],[1,"text-center"],["fxLayout","column","fxLayoutAlign","space-evenly center","fxFlex","30%",1,"text-center"],["class","w-full mat-elevation-z3 mt-5",4,"ngIf"],["fxLayout","column","fxLayoutAlign","space-around start","fxFlex","40%"],["fxLayout","column","fxLayoutAlign","space-around start",1,"mat-elevation-z3","rounded-md","p-2","mb-5","w-full"],["fxLayout","row","fxLayoutAlign","space-between center",1,"w-full","px-2"],["fxLayout","row","fxLayoutAlign","space-between start",1,"w-full"],["mat-icon-button",""],[1,"p-5"],["matListIcon","",1,"material-icons-outlined"],["class","material-icons-outlined text-blue-500",4,"ngIf"],[4,"ngIf"],[1,"w-full","mat-elevation-z3","mt-5"],["fxLayout","row","fxLayoutGap","10px","fxLayoutAlign","start center",1,"card","bg-white","w-full","mat-elevation-z2","px-2","py-2"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","10px",1,"text-lg","font-thin"],["class","text-lg font-thin","fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","10px",4,"ngIf"],["mat-table","",1,"mat-elevation-z3","w-full",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","reference"],["matColumnDef","category"],["matColumnDef","store"],["matColumnDef","amount"],["matColumnDef","createdAt"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page of periodic elements",3,"pageSizeOptions"],["mat-stroked-button","","color","primary"],["mat-stroked-button","","color","warn",3,"click"],["mat-header-cell",""],[3,"checked","indeterminate","aria-label","change"],["mat-cell",""],[3,"checked","aria-label","click","change"],["mat-icon-button","","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],[1,"material-icons-outlined"],["mat-menu-item","",3,"routerLink"],["mat-header-row",""],["mat-row",""],[1,"material-icons-outlined","text-blue-500"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),t.NdJ("click",function(){return n.back()}),t.TgZ(4,"mat-icon",4),t._uU(5,"arrow_back_ios"),t.qZA()(),t.TgZ(6,"div",5)(7,"h2",6),t._uU(8),t.qZA(),t.TgZ(9,"p"),t._uU(10,"Customer for over 5 years"),t.qZA()()(),t.TgZ(11,"div",7)(12,"button",8),t._uU(13,"Message User"),t.qZA(),t.TgZ(14,"button",9),t.NdJ("click",function(){return n.disableAccount()}),t._uU(15),t.qZA(),t.TgZ(16,"button",10),t.NdJ("click",function(){return n.deleteAccount()}),t._uU(17,"Delete User"),t.qZA()()(),t.TgZ(18,"div",11)(19,"div",12)(20,"div",13)(21,"div",14)(22,"p",15),t._uU(23,"Amount spent"),t.qZA(),t.TgZ(24,"h1",15),t._uU(25),t.ALo(26,"currency"),t.qZA()(),t.TgZ(27,"div",16)(28,"p",15),t._uU(29,"Orders"),t.qZA(),t.TgZ(30,"h1",15),t._uU(31),t.qZA()(),t.TgZ(32,"div",16)(33,"p",15),t._uU(34,"Average order value"),t.qZA(),t.TgZ(35,"h1",15),t._uU(36),t.ALo(37,"currency"),t.qZA()()(),t.YNc(38,Rt,31,6,"div",17),t.ALo(39,"async"),t.qZA(),t.TgZ(40,"div",18)(41,"div",19)(42,"div",20)(43,"div",21)(44,"button",8),t._uU(45,"Notes"),t.qZA(),t.TgZ(46,"button",22)(47,"mat-icon",4),t._uU(48,"edit"),t.qZA()()()(),t.TgZ(49,"div")(50,"p",23),t._uU(51),t.qZA()()(),t.TgZ(52,"div",19)(53,"div",20)(54,"div",21)(55,"button",8),t._uU(56,"Customers"),t.qZA(),t.TgZ(57,"button",3),t.NdJ("click",function(){return n.openCustomerBasicInfo()}),t.TgZ(58,"mat-icon",4),t._uU(59,"edit"),t.qZA()()()(),t.TgZ(60,"mat-list")(61,"mat-list-item")(62,"mat-icon",24),t._uU(63,"email"),t.qZA(),t._uU(64),t.qZA(),t.TgZ(65,"mat-list-item")(66,"mat-icon",24),t._uU(67,"call"),t.qZA(),t._uU(68),t.YNc(69,Yt,2,0,"mat-icon",25),t.qZA(),t.YNc(70,It,4,1,"mat-list-item",26),t.YNc(71,Jt,4,1,"mat-list-item",26),t.YNc(72,Mt,4,1,"mat-list-item",26),t.YNc(73,Ot,4,1,"mat-list-item",26),t.qZA()(),t.TgZ(74,"div",19)(75,"div",20)(76,"div",21)(77,"button",8),t._uU(78,"Marketing status"),t.qZA(),t.TgZ(79,"button",3),t.NdJ("click",function(){return n.openCustomerMarketingStatus()}),t.TgZ(80,"mat-icon",4),t._uU(81,"edit"),t.qZA()()()(),t.TgZ(82,"mat-list")(83,"mat-list-item")(84,"mat-icon",24),t._uU(85,"notifications_active"),t.qZA(),t._uU(86),t.qZA(),t.TgZ(87,"mat-list-item")(88,"mat-icon",24),t._uU(89,"campaign"),t.qZA(),t._uU(90),t.qZA()()()()()()),2&e&&(t.xp6(8),t.Oqu(n.customer.name),t.xp6(7),t.Oqu(n.customer.deleteAccount?"Enable Account":"Disable Account"),t.xp6(1),t.Q6J("color","warn"),t.xp6(9),t.Oqu(t.lcZ(26,17,n.customer.totalAmountSpent)),t.xp6(6),t.Oqu(n.customer.totalOrders),t.xp6(5),t.Oqu(t.lcZ(37,19,n.customer.avgAmountSpent)),t.xp6(2),t.Q6J("ngIf",t.lcZ(39,21,n.orders$)),t.xp6(13),t.Oqu(n.customer.notes?n.customer.notes:"No notes about this customer"),t.xp6(13),t.Oqu(n.customer.email),t.xp6(4),t.hij("",n.customer.phoneNumber," "),t.xp6(1),t.Q6J("ngIf",n.customer.verifyPhoneNumber),t.xp6(1),t.Q6J("ngIf",n.customer.shipping),t.xp6(1),t.Q6J("ngIf",n.customer.country),t.xp6(1),t.Q6J("ngIf",n.customer.gender),t.xp6(1),t.Q6J("ngIf",n.customer.language),t.xp6(13),t.hij(" ",n.customer.allowNotifications?"Mobile Notification Subscribed":"Mobile Notification Unsubscribed",""),t.xp6(4),t.hij(" ",n.customer.allowSalesNotifications?"Sales Notification Subscribed":"Sales Notification Unsubscribed",""))},dependencies:[p.O5,_.rH,C.lW,C.RK,U.Hw,x.NW,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,q.oG,Z.VK,Z.OP,Z.p6,w.i$,w.Tg,m.xw,m.SQ,m.Wh,m.yH,p.Ov,p.H9,p.uU]}),o})(),resolve:{customer:v}}]}];let Ft=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[_.Bz.forChild(Qt),_.Bz]}),o})();var Et=a(6005),Gt=a(1447),Bt=a(712);let $t=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({providers:[v,T,g.f,Bt.T],imports:[p.ez,Ft,Et.q,Gt.o9,r.UX]}),o})()}}]);