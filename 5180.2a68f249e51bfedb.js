"use strict";(self.webpackChunkshopbot=self.webpackChunkshopbot||[]).push([[5180],{5180:(rt,u,r)=>{r.r(u),r.d(u,{OrdersComponent:()=>at});var E=r(8141),g=r(6354),p=r(6440),m=r(2042),i=r(9159),D=r(3534),f=r(5749),M=r(5024),P=r(1269),c=r(177),T=r(6924),h=r(9417),F=r(3457),t=r(3953),R=r(5351),b=r(8498),S=r(8834),O=r(3719),y=r(9213),v=r(9631),_=r(9115);const x=()=>[5,10,25,100];function I(e,o){1&e&&(t.j41(0,"th",22),t.EFF(1," Order Number "),t.k0s())}function j(e,o){if(1&e&&(t.j41(0,"td",23),t.EFF(1),t.k0s()),2&e){const n=o.$implicit;t.R7$(),t.SpI(" ",n.reference," ")}}function A(e,o){1&e&&t.nrm(0,"td",24)}function B(e,o){1&e&&(t.j41(0,"td",24)(1,"h2"),t.EFF(2,"Total"),t.k0s()())}function U(e,o){1&e&&(t.j41(0,"th",22),t.EFF(1," Date "),t.k0s())}function k(e,o){if(1&e&&(t.j41(0,"td",23),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&e){const n=o.$implicit;t.R7$(),t.SpI(" ",t.i5U(2,1,n.createdAt,"MMM d, y, h:mm:ss a")," ")}}function L(e,o){1&e&&t.nrm(0,"td",24)}function $(e,o){1&e&&(t.j41(0,"th",22),t.EFF(1," Order Status "),t.k0s())}function w(e,o){if(1&e&&(t.j41(0,"td",23),t.EFF(1),t.k0s()),2&e){const n=o.$implicit;t.R7$(),t.SpI(" ",n.status[0].name,"")}}function K(e,o){1&e&&t.nrm(0,"td",24)}function W(e,o){1&e&&(t.j41(0,"th",22),t.EFF(1," Amount "),t.k0s())}function V(e,o){if(1&e&&(t.j41(0,"td",23),t.EFF(1),t.nI1(2,"currency"),t.k0s()),2&e){const n=o.$implicit,a=t.XpG();t.R7$(),t.SpI(" ",t.i5U(2,1,n.total,a.store.currency)," ")}}function G(e,o){if(1&e&&(t.j41(0,"td",24)(1,"h2"),t.EFF(2),t.nI1(3,"currency"),t.k0s()()),2&e){const n=t.XpG();t.R7$(2),t.JRh(t.bMT(3,1,n.getTotalCost))}}function N(e,o){1&e&&(t.j41(0,"th",22),t.EFF(1," Payment Status "),t.k0s())}function Y(e,o){if(1&e&&(t.j41(0,"td",23),t.EFF(1),t.k0s()),2&e){const n=o.$implicit;t.R7$(),t.SpI(" ",null==n?null:n.paymentStatus," ")}}function X(e,o){1&e&&t.nrm(0,"td",24)}function z(e,o){1&e&&(t.j41(0,"th",22),t.EFF(1," Payment Type "),t.k0s())}function J(e,o){if(1&e&&(t.j41(0,"td",23),t.EFF(1),t.k0s()),2&e){const n=o.$implicit;t.R7$(),t.SpI(" ",n.payment," ")}}function Z(e,o){1&e&&t.nrm(0,"td",24)}function H(e,o){1&e&&(t.j41(0,"th",22),t.EFF(1," Actions "),t.k0s())}function Q(e,o){if(1&e){const n=t.RV6();t.j41(0,"td",23)(1,"button",25)(2,"mat-icon"),t.EFF(3,"more_vert"),t.k0s()(),t.j41(4,"mat-menu",null,1)(6,"button",26),t.bIt("click",function(){const s=t.eBV(n),l=s.$implicit,C=s.index,d=t.XpG();return t.Njj(d.deleteOrder(C,l))}),t.j41(7,"mat-icon"),t.EFF(8,"delete"),t.k0s(),t.j41(9,"span"),t.EFF(10,"Delete"),t.k0s()(),t.j41(11,"button",27)(12,"mat-icon"),t.EFF(13,"visibility"),t.k0s(),t.j41(14,"span"),t.EFF(15,"View Order"),t.k0s()()()()}if(2&e){const n=t.sdS(5);t.R7$(),t.Y8G("matMenuTriggerFor",n)}}function q(e,o){1&e&&t.nrm(0,"td",24)}function tt(e,o){1&e&&t.nrm(0,"tr",28)}function et(e,o){1&e&&t.nrm(0,"tr",29)}function nt(e,o){if(1&e&&(t.j41(0,"tr",30)(1,"td",31),t.EFF(2),t.k0s()()),2&e){t.XpG();const n=t.sdS(5);t.R7$(2),t.SpI('No data matching the filter "',n.value,'"')}}function ot(e,o){1&e&&t.nrm(0,"tr",32)}let at=(()=>{class e{constructor(n,a,s,l){this.socket=n,this.storeService=a,this._matDialog=s,this.route=l,this.displayedColumns=["reference","date","status","amount","paymentStatus","paymentType","actions"],this.selection=new M.CB(!0,[]),this.statuses=[{id:0,name:"Pending",color:"bg-blue-300"},{id:1,name:"Approve",color:"bg-blue-400"},{id:3,name:"Canceled",color:"bg-blue-400"},{id:2,name:"Shipped",color:"bg-blue-400"},{id:3,name:"Completed",color:"bg-green-400"}],this.store=this.route.parent?.parent?.snapshot.data.store,this.dataSource=new i.I6}compareFn(n,a){return n.name===a}isAllSelected(){return this.selection.selected.length===this.dataSource.data.length}toggleAllRows(){this.isAllSelected()?this.selection.clear():this.selection.select(...this.dataSource.data)}checkboxLabel(n){return n?`${this.selection.isSelected(n)?"deselect":"select"} row ${n.position+1}`:(this.isAllSelected()?"deselect":"select")+" all"}ngOnInit(){this.getOrders(),this.getOrder()}deleteOrder(n,a){this.confirmDialogRef=this._matDialog.open(P.Y,{disableClose:!1}),this.confirmDialogRef.componentInstance.title="Delete Item?",this.confirmDialogRef.componentInstance.confirmMessage="Are you sure you want to delete this order?",this.confirmDialogRef.componentInstance.confirmButton="Delete",this.confirmDialogRef.afterClosed().subscribe(s=>{s&&(this.dataSource.data.splice(n,1),this.dataSource._updateChangeSubscription(),this.storeService.deleteStoreOrders(a._id).subscribe())})}getOrders(){this.storeService.getStoreOrders(this.store._id).pipe((0,E.M)(n=>{this.dataSource=new i.I6(n)})).subscribe()}get getTotalCost(){return this.dataSource.data.map(n=>n.total).reduce((n,a)=>n+a,0)}getOrder(){return this.socket.fromEvent("order").pipe((0,g.T)(n=>n)).subscribe(n=>{n&&(this.dataSource.data.unshift(n),this.dataSource._updateChangeSubscription())})}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}applyFilter(n){this.dataSource.filter=n.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}changeValue(n,a){this.storeService.updateOrderStatus(a._id,a.user._id,n.value).subscribe(s=>{console.log(s)})}static#t=this.\u0275fac=function(a){return new(a||e)(t.rXU(D.y),t.rXU(f.n),t.rXU(R.bZ),t.rXU(b.nX))};static#e=this.\u0275cmp=t.VBU({type:e,selectors:[["app-orders-tab"]],viewQuery:function(a,s){if(1&a&&(t.GBs(p.iy,5),t.GBs(m.B4,5)),2&a){let l;t.mGM(l=t.lsd())&&(s.paginator=l.first),t.mGM(l=t.lsd())&&(s.sort=l.first)}},standalone:!0,features:[t.Jv_([f.n]),t.aNF],decls:42,vars:7,consts:[["input",""],["menu","matMenu"],[2,"padding","20px"],["appearance","fill"],["matInput","","cancellation","Search Order",3,"keyup"],[1,"mat-elevation-z6","example-container"],["mat-table","","matSort","",1,"w-full",2,"width","100%",3,"dataSource"],["matColumnDef","reference"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["matColumnDef","date"],["matColumnDef","status"],["matColumnDef","amount"],["matColumnDef","paymentStatus"],["matColumnDef","paymentType"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["mat-footer-row","",4,"matFooterRowDef","matFooterRowDefSticky"],["aria-label","Select page of users",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-footer-cell",""],["mat-icon-button","","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item",""],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","9",1,"mat-cell"],["mat-footer-row",""]],template:function(a,s){if(1&a){const l=t.RV6();t.j41(0,"div",2)(1,"mat-form-field",3)(2,"mat-label"),t.EFF(3,"Filter"),t.k0s(),t.j41(4,"input",4,0),t.bIt("keyup",function(d){return t.eBV(l),t.Njj(s.applyFilter(d))}),t.k0s()(),t.j41(6,"div",5)(7,"table",6),t.qex(8,7),t.DNE(9,I,2,0,"th",8)(10,j,2,1,"td",9)(11,A,1,0,"td",10)(12,B,3,0,"td",10),t.bVm(),t.qex(13,11),t.DNE(14,U,2,0,"th",8)(15,k,3,4,"td",9)(16,L,1,0,"td",10),t.bVm(),t.qex(17,12),t.DNE(18,$,2,0,"th",8)(19,w,2,1,"td",9)(20,K,1,0,"td",10),t.bVm(),t.qex(21,13),t.DNE(22,W,2,0,"th",8)(23,V,3,4,"td",9)(24,G,4,3,"td",10),t.bVm(),t.qex(25,14),t.DNE(26,N,2,0,"th",8)(27,Y,2,1,"td",9)(28,X,1,0,"td",10),t.bVm(),t.qex(29,15),t.DNE(30,z,2,0,"th",8)(31,J,2,1,"td",9)(32,Z,1,0,"td",10),t.bVm(),t.qex(33,16),t.DNE(34,H,2,0,"th",8)(35,Q,16,1,"td",9)(36,q,1,0,"td",10),t.bVm(),t.DNE(37,tt,1,0,"tr",17)(38,et,1,0,"tr",18)(39,nt,3,1,"tr",19)(40,ot,1,0,"tr",20),t.k0s(),t.nrm(41,"mat-paginator",21),t.k0s()()}2&a&&(t.R7$(7),t.Y8G("dataSource",s.dataSource),t.R7$(30),t.Y8G("matHeaderRowDef",s.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",s.displayedColumns),t.R7$(2),t.Y8G("matFooterRowDef",s.displayedColumns)("matFooterRowDefSticky",!0),t.R7$(),t.Y8G("pageSizeOptions",t.lJ4(6,x)))},dependencies:[F.G,S.iY,O.rl,O.nJ,y.An,v.fg,p.iy,m.B4,m.aE,i.Zl,i.tL,i.ji,i.cC,i.YV,i.iL,i.Zq,i.xW,i.KS,i.$R,i.Qo,i.YZ,i.NB,i.iF,i.ky,_.kk,_.fb,_.Cp,c.MD,c.oe,c.vh,h.YN,h.X1,T.YF],styles:["body[_ngcontent-%COMP%]{font-family:Covered By Your Grace,cursive;line-height:1.25}@media screen and (max-width: 960px){.mat-table[_ngcontent-%COMP%]{border:0;vertical-align:middle}.mat-table[_ngcontent-%COMP%]   caption[_ngcontent-%COMP%]{font-size:1em}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{border-bottom:5px solid #ddd;display:block}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{border-bottom:1px solid #ddd;display:block;font-size:1em;text-align:right;font-weight:700;height:30px;margin-bottom:4%}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]:before{content:attr(data-label);float:left;text-transform:uppercase;font-weight:400;font-size:.85em}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]:last-child{border-bottom:0}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]:first-child{margin-top:4%}}"]})}return e})()}}]);