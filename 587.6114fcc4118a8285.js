"use strict";(self.webpackChunkshopbot=self.webpackChunkshopbot||[]).push([[587],{7587:(H,g,r)=>{r.r(g),r.d(g,{FinanceModule:()=>z});var s=r(6814),l=r(1896),t=r(5879);let T=(()=>{class n{constructor(){}ngOnInit(){}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-finance"]],decls:1,vars:0,template:function(o,a){1&o&&t._UZ(0,"router-outlet")},dependencies:[l.lC]})}return n})();var u=r(6676),i=r(6223),y=r(9397),F=r(3997),U=r(7921),C=r(4664),h=r(7069),L=r(7747),Z=r(9862),O=r(553);let p=(()=>{class n{constructor(e){this._httpClient=e,this.hostServer=O.N.hostServer}getFinances(e){let o=new Z.LE({fromObject:e});return this._httpClient.get(`${this.hostServer}/transactions/financial/reports?${o.toString()}`)}static#t=this.\u0275fac=function(o){return new(o||n)(t.LFG(Z.eN))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac})}return n})();var q=r(7700),S=r(2296),m=r(9157),c=r(8034),v=r(3814),I=r(7509);const M=["pdfTable"];function w(n,d){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Invalid start date"),t.qZA())}function N(n,d){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Invalid end date"),t.qZA())}function Y(n,d){if(1&n&&(t.TgZ(0,"tr",24)(1,"td",25)(2,"div",21),t._uU(3),t.qZA()(),t.TgZ(4,"td",26),t._uU(5),t.ALo(6,"date"),t.qZA(),t.TgZ(7,"th",27)(8,"div",28)(9,"div",29),t._uU(10),t.qZA(),t.TgZ(11,"div",30),t._uU(12),t.qZA()()(),t.TgZ(13,"td",26),t._uU(14),t.qZA(),t.TgZ(15,"td",26),t._uU(16),t.ALo(17,"currency"),t.qZA(),t.TgZ(18,"td",26),t._uU(19),t.ALo(20,"currency"),t.qZA(),t.TgZ(21,"td",26),t._uU(22),t.qZA(),t.TgZ(23,"td",26),t._uU(24),t.ALo(25,"currency"),t.qZA()()),2&n){const e=d.$implicit,o=d.index;t.xp6(3),t.hij(" ",o+1," "),t.xp6(2),t.hij(" ",t.xi3(6,10,e.createdAt,"dd-MM-YYYY MM:HH:SS")," "),t.xp6(5),t.Oqu(e.user.name),t.xp6(2),t.hij("Order from ",e.store.name,""),t.xp6(2),t.hij(" #",e.reference," "),t.xp6(2),t.hij(" ",t.xi3(17,13,e.serviceFee,e.store.currency)," "),t.xp6(3),t.hij(" ",t.xi3(20,16,e.shippingFee,e.store.currency)," "),t.xp6(3),t.AsE(" ",e.vendorCommissionAmount,"(%",e.vendorCommission,") "),t.xp6(2),t.hij(" ",t.xi3(25,19,e.total,e.store.currency)," ")}}function D(n,d){if(1&n){const e=t.EpF();t.TgZ(0,"div",1,2)(2,"div",3)(3,"div",4)(4,"p"),t._uU(5,"Export"),t.qZA(),t.TgZ(6,"button",5),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.exportPDF())}),t._uU(7,"PDF"),t.qZA()(),t.TgZ(8,"mat-form-field",6)(9,"mat-label"),t._uU(10,"Enter a date range"),t.qZA(),t.TgZ(11,"mat-date-range-input",7),t._UZ(12,"input",8)(13,"input",9),t.qZA(),t._UZ(14,"mat-datepicker-toggle",10)(15,"mat-date-range-picker",null,11),t.YNc(17,w,2,0,"mat-error",12),t.YNc(18,N,2,0,"mat-error",12),t.qZA()(),t.TgZ(19,"div",13)(20,"dl",14)(21,"div",15)(22,"dt",16),t._uU(23),t.qZA(),t.TgZ(24,"dd",17),t._uU(25,"Total Orders"),t.qZA()(),t.TgZ(26,"div",15)(27,"dt",16),t._uU(28),t.ALo(29,"currency"),t.qZA(),t.TgZ(30,"dd",17),t._uU(31,"Total Customer Delivery Fee"),t.qZA()(),t.TgZ(32,"div",15)(33,"dt",16),t._uU(34),t.ALo(35,"currency"),t.qZA(),t.TgZ(36,"dd",17),t._uU(37,"Total Customer Commissions"),t.qZA()(),t.TgZ(38,"div",15)(39,"dt",16),t._uU(40),t.ALo(41,"currency"),t.qZA(),t.TgZ(42,"dd",17),t._uU(43,"Total Vendor Commissions"),t.qZA()(),t.TgZ(44,"div",15)(45,"dt",16),t._uU(46),t.ALo(47,"currency"),t.qZA(),t.TgZ(48,"dd",17),t._uU(49,"Total Sales"),t.qZA()(),t.TgZ(50,"div",15)(51,"dt",16),t._uU(52),t.ALo(53,"currency"),t.qZA(),t.TgZ(54,"dd",17),t._uU(55,"Total Expenses"),t.qZA()(),t.TgZ(56,"div",15)(57,"dt",16),t._uU(58),t.ALo(59,"currency"),t.qZA(),t.TgZ(60,"dd",17),t._uU(61,"Gross Profits"),t.qZA()(),t.TgZ(62,"div",15)(63,"dt",16),t._uU(64),t.ALo(65,"currency"),t.qZA(),t.TgZ(66,"dd",17),t._uU(67,"Net income"),t.qZA()()()(),t.TgZ(68,"table",18)(69,"thead",19)(70,"tr")(71,"th",20)(72,"div",21),t._uU(73," S/N "),t.qZA()(),t.TgZ(74,"th",20),t._uU(75," Created "),t.qZA(),t.TgZ(76,"th",22),t._uU(77," Name "),t.qZA(),t.TgZ(78,"th",22),t._uU(79," Order Number "),t.qZA(),t.TgZ(80,"th",22),t._uU(81," Service Fee "),t.qZA(),t.TgZ(82,"th",22),t._uU(83," Shipping Fee "),t.qZA(),t.TgZ(84,"th",22),t._uU(85," Vendor Commission "),t.qZA(),t.TgZ(86,"th",22),t._uU(87," Total "),t.qZA()()(),t.TgZ(88,"tbody"),t.YNc(89,Y,26,22,"tr",23),t.qZA()()()}if(2&n){const e=d.ngIf,o=t.MAs(16),a=t.oxw();t.xp6(11),t.Q6J("formGroup",a.range)("rangePicker",o),t.xp6(3),t.Q6J("for",o),t.xp6(3),t.Q6J("ngIf",a.range.controls.start.hasError("matStartDateInvalid")),t.xp6(1),t.Q6J("ngIf",a.range.controls.end.hasError("matEndDateInvalid")),t.xp6(5),t.Oqu(e.orders.length),t.xp6(5),t.Oqu(t.xi3(29,14,e.deliveryFee,"\u20a6")),t.xp6(6),t.Oqu(t.xi3(35,17,e.customersServiceFee,"\u20a6")),t.xp6(6),t.Oqu(t.xi3(41,20,e.totalVendorCommissionAmount,"\u20a6")),t.xp6(6),t.Oqu(t.xi3(47,23,e.ordersTotal,"\u20a6")),t.xp6(6),t.Oqu(t.xi3(53,26,e.fundRequestsTotal,"\u20a6")),t.xp6(6),t.Oqu(t.xi3(59,29,e.totalProfits,"\u20a6")),t.xp6(6),t.Oqu(t.xi3(65,32,e.totalProfits-e.fundRequestsTotal,"\u20a6")),t.xp6(25),t.Q6J("ngForOf",e.orders)}}const x=u().startOf("month").toDate(),A=u().endOf("month").toDate(),b=r(8777);h.vfs=L.I.vfs;const E=[{path:"",component:T,children:[{path:"list",component:(()=>{class n{constructor(e,o,a,f){this.route=e,this.financesService=o,this._matDialog=a,this.router=f,this.range=new i.cw({start:new i.NI(x),end:new i.NI(A)}),this.isLoading=!1}ngAfterViewInit(){}ngOnInit(){this.getFinances()}openModal(e){this.router.navigate(["dashboard","reports","payouts",e,"details"])}getFinances(){this.finances$=this.range.valueChanges.pipe((0,y.b)(()=>this.isLoading=!0),(0,F.x)(),(0,U.O)({start:x,end:A}),(0,C.w)(e=>this.financesService.getFinances(e)))}exportPDF(){var o=b(this.pdfTable.nativeElement.innerHTML);h.createPdf({content:o}).download()}static#t=this.\u0275fac=function(o){return new(o||n)(t.Y36(l.gz),t.Y36(p),t.Y36(q.uw),t.Y36(l.F0))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-finance-list"]],viewQuery:function(o,a){if(1&o&&t.Gf(M,5),2&o){let f;t.iGM(f=t.CRH())&&(a.pdfTable=f.first)}},decls:2,vars:3,consts:[["class","relative overflow-x-auto shadow-md sm:rounded-lg","id","pdfTable",4,"ngIf"],["id","pdfTable",1,"relative","overflow-x-auto","shadow-md","sm:rounded-lg"],["pdfTable",""],["fxLayout","row","fxLayoutAlign","space-between start","fxLayout.lt-md","column","fxLayoutAlign.lt-md","start stretch",1,"p-3","bg-white"],["ngClass.lt-md","mb-5 w-full"],["mat-raised-button","",3,"click"],["appearance","fill"],[3,"formGroup","rangePicker"],["matStartDate","","formControlName","start","placeholder","Start date"],["matEndDate","","formControlName","end","placeholder","End date"],["matSuffix","",3,"for"],["picker",""],[4,"ngIf"],["id","stats",1,"p-4","bg-white","rounded-lg","md:p-8"],[1,"grid","max-w-screen-xl","grid-cols-1","gap-8","p-4","mx-auto","text-gray-900","sm:grid-cols-1","xl:grid-cols-3","sm:p-8"],[1,"flex","flex-col","items-center","justify-center"],[1,"mb-2","text-3xl","font-extrabold"],[1,"text-gray-500"],[1,"w-full","text-sm","text-left"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50"],["scope","col",1,"p-4"],[1,"flex","items-center"],["scope","col",1,"px-6","py-3"],["class","bg-white border-b ",4,"ngFor","ngForOf"],[1,"bg-white","border-b"],[1,"w-4","p-4"],[1,"px-6","py-4"],["scope","row",1,"flex","items-center","px-6","py-4","font-medium","text-gray-900","whitespace-nowrap"],[1,"pl-3"],[1,"text-base","font-semibold"],[1,"font-normal","text-gray-500"]],template:function(o,a){1&o&&(t.YNc(0,D,90,35,"div",0),t.ALo(1,"async")),2&o&&t.Q6J("ngIf",t.lcZ(1,1,a.finances$))},dependencies:[s.sg,s.O5,S.lW,m.KE,m.hX,m.TO,m.R9,c.nW,c.wx,c.zY,c.By,c._g,v.xw,v.Wh,I.oO,i.Fj,i.JJ,i.JL,i.sg,i.u,s.Ov,s.H9,s.uU]})}return n})()}]}];let j=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({imports:[l.Bz.forChild(E),l.Bz]})}return n})();var J=r(1447),P=r(6005),G=r(6208);let Q=(()=>{class n{constructor(e){this.financesService=e}resolve(){const e=u().startOf("month").toDate(),o=u().endOf("month").toDate();return this.financesService.getFinances({start:e,end:o})}static#t=this.\u0275fac=function(o){return new(o||n)(t.LFG(p))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),z=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({providers:[p,Q],imports:[s.ez,j,P.q,J.o9,i.UX,i.u5,G.m,c.FA]})}return n})()}}]);